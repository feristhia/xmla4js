(function(U){var p,H="http://schemas.xmlsoap.org/soap/",ac=H+"envelope/",Z="SOAP-ENV",J="xmlns:"+Z+'="'+ac+'"',o=Z+':encodingStyle="'+H+'encoding/"',l="urn:schemas-microsoft-com:",j=l+"xml-analysis",L='xmlns="'+j+'"',n="sql",h=l+"xml-sql",v="http://www.w3.org/2001/XMLSchema",B="xsd",aa="http://www.w3.org/2001/XMLSchema-instance",X="xsi",D=j+":rowset",ab=j+":mddataset";var I;if(U.XMLHttpRequest){I=function(){return new U.XMLHttpRequest()}}else{if(U.ActiveXObject){I=function(){return new U.ActiveXObject("MSXML2.XMLHTTP.3.0")}}else{if(typeof(require)==="function"){I=function(){var ad;(ad=function(){this.readyState=0;this.status=-1;this.statusText="Not sent";this.responseText=null}).prototype={changeStatus:function(af,ae){this.status=af;this.statusText=af;this.readyState=ae;if(f(this.onreadystatechange)){this.onreadystatechange.call(this,this)}},open:function(aj,ag,ah,ai,af){if(ah!==true){throw"Synchronous mode not supported in this environment."}var ae=require("url").parse(ag);if(ae.host.length>ae.hostname.length){ae.host=ae.hostname;delete ae.hostname}if(!ae.path&&ae.pathname){ae.path=ae.pathname+(ae.search||"")}ae.method="POST";ae.headers={};if(ai){ae.headers.Authorization="Basic "+(new Buffer(ai+":"+(af||""))).toString("base64")}this.options=ae;this.changeStatus(-1,1)},send:function(ai){var ah=this,af=ah.options,ae;af.headers["Content-Length"]=Buffer.byteLength(ai);switch(af.protocol){case"http:":ae=require("http");if(!af.port){af.port="80"}break;case"https:":ae=require("https");if(!af.port){af.port="443"}break;default:throw"Unsupported protocol "+af.protocol}ah.responseText="";var ag=ae.request(af,function(aj){aj.setEncoding("utf8");ah.changeStatus(-1,2);aj.on("data",function(ak){ah.responseText+=ak;ah.changeStatus(aj.statusCode,3)});aj.on("error",function(ak){ah.changeStatus(aj.statusCode,4)});aj.on("end",function(){ah.changeStatus(aj.statusCode,4)})});ag.on("error",function(aj){ah.responseText=aj;ah.changeStatus(500,4)});if(ai){ag.write(ai)}ag.end()},setRequestHeader:function(ae,af){this.options.headers[ae]=af}};return new ad()}}else{p.Exception._newError("ERROR_INSTANTIATING_XMLHTTPREQUEST","_ajax",null)._throw()}}}function N(af){var ai,ae,ah,aj,ad=false,ag=function(){ad=true;switch(ai.readyState){case 0:if(f(af.aborted)){af.aborted(ai)}break;case 4:if(ai.status===200){af.complete(ai)}else{var ak=p.Exception._newError("HTTP_ERROR","_ajax",{request:af,status:this.status,statusText:this.statusText});af.error(ak)}break}};ai=I();ae=["POST",af.url,af.async];if(af.username&&af.password){ae=ae.concat([af.username,af.password])}ai.timeout=af.timeout;ai.open.apply(ai,ae);ai.onreadystatechange=ag;ai.setRequestHeader("Accept","text/xml, application/xml, application/soap+xml");ai.setRequestHeader("Content-Type","text/xml");if(ah=af.headers){for(aj in ah){ai.setRequestHeader(aj,ah[aj])}}ai.send(af.data);if(!af.async&&!ad){ag.call(ai)}return ai}function R(ad){return typeof(ad)==="undefined"}function K(ad){return ad&&ad.constructor===Array}function i(ad){return typeof(ad)==="number"}function f(ad){return typeof(ad)==="function"}function W(ad){return typeof(ad)==="string"}function u(ad){return ad&&typeof(ad)==="object"}function r(ad){if(W(ad)){ad=ad.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}return ad}function A(ad){return ad.replace(/_x(\d\d\d\d)_/g,function(ae,af,ag){return String.fromCharCode(parseInt(af,16))})}function k(ae,ag,aj){var ah=ae.childNodes;if(!ah){return ag}for(var af,ad=0,ai=ah.length;ad<ai;ad++){af=ah[ad];if(aj&&aj.call(null,af)===true){ag.push(af)}k(af,ag,aj)}}var V=function(af,ad){var ae;if(af.getElementsByTagName){ae=function(ah,ag){return ah.getElementsByTagName(ag)}}else{ae=function(ah,ag){var ai=[],aj=ag==="*"?null:function(ak){return(ak.nodeType===1&&((ak.namespaceURI===""?"":ak.prefix+":")+ak.nodeName)===ag)};k(ah,ai,aj);return ai}}return(V=ae)(af,ad)};var Y=function(ag,ae,ah,ad){var af;if(ag.getElementsByTagNameNS){af=function(ak,aj,al,ai){return ak.getElementsByTagNameNS(aj,ai)}}else{if(ag.getElementsByTagName){af=function(ak,aj,al,ai){return ak.getElementsByTagName((al?al+":":"")+ai)}}else{af=function(ak,aj,am,ai){var al=[],an;if(ai==="*"){an=function(ao){return(ao.nodeType===1&&ao.namespaceURI===aj)}}else{an=function(ao){return(ao.nodeType===1&&ao.namespaceURI===aj&&ao.nodeName===ai)}}k(ak,al,an);return al}}}Y=af;return af(ag,ae,ah,ad)};var T=function(ae,af,ah,ad){var ag;if(ae.getAttributeNS){ag=function(aj,ak,al,ai){return aj.getAttributeNS(ak,ai)}}else{if(ae.getAttribute){ag=function(aj,ak,al,ai){return aj.getAttribute((al?al+":":"")+ai)}}else{ag=function(an,al,ao,ak){var aj=an.attributes;if(!aj){return null}for(var ai,am=0,ap=aj.length;am<ap;am++){ai=aj[am];if(ai.namespaceURI===al&&ai.nodeName===ak){return ai.value}}return null}}}return(T=ag)(ae,af,ah,ad)};var m=function(af,ad){var ae;if(af.getAttribute){ae=function(ah,ag){return ah.getAttribute(ag)}}else{ae=function(ak,ai){var ah=ak.attributes;if(!ah){return null}for(var ag,aj=0,al=ah.length;aj<al;aj++){ag=ah[aj];if(ag.nodeName===ai){return ag.value}}return null}}return(m=ae)(af,ad)};function x(ad){var ae;if(!R(ad.innerText)){ae=function(af){return af.innerText}}else{if(!R(ad.textContent)){ae=function(af){return af.textContent}}else{if(!R(ad.nodeTypedValue)){ae=function(af){return af.nodeTypedValue}}else{if(ad.normalize){ae=function(af){af.normalize();if(af.firstChild){return af.firstChild.data}else{return null}}}else{ae=function(ah){var aj=[],ag,ai=ah.childNodes,af,ak=ai?ai.length:0;for(af=0;af<ak;af++){ag=ai[af];if(ag.data!==null){aj.push(ag.data)}}return aj.length?aj.join(""):null}}}}}x=ae;return ae(ad)}function G(ad,aj,ai,ag){if(!ag){ag=""}var af,ah,ak,al,am,ae="\n"+ag+"<"+ad+">";if(ai){ae+="\n"+ag+" <"+aj+">";for(al in ai){if(ai.hasOwnProperty(al)){am=ai[al];ae+="\n"+ag+"  <"+al+">";if(K(am)){af=am.length;for(ah=0;ah<af;ah++){ak=am[ah];ae+="<Value>"+r(ak)+"</Value>"}}else{ae+=r(am)}ae+="</"+al+">"}}ae+="\n"+ag+" </"+aj+">"}ae+="\n"+ag+"</"+ad+">";return ae}var c="RequestType";function g(ae,af,ad){if(af&&(!ae)){ae={}}var ag;for(ag in af){if(af.hasOwnProperty(ag)){if(ad||R(ae[ag])){ae[ag]=af[ag]}}}return ae}function w(ah){var ao=/<(((([\w\-\.]+):)?([\w\-\.]+))([^>]+)?|\/((([\w\-\.]+):)?([\w\-\.]+))|\?(\w+)([^\?]+)?\?|(!--([^\-]|-[^\-])*--))>|([^<>]+)/ig,ai,aC,aw,ap,au,am,ae,al,aB={"":""},ay,an,aA,aj,ak=[],az,at=null;aA=aj={nodeType:9,childNodes:[]};function af(){ak.push(aB);var aD=new (function(){});aD.constructor.prototype=aB;aB=new aD.constructor();at.namespaces=aB;ay=true}function av(){aB=ak.pop()}while(ai=ao.exec(ah)){at=null;if(aC=ai[5]){ay=false;at={offset:ai.index,parentNode:aj,nodeType:1,nodeName:aC};az=at;if(ap=ai[6]){if(ap.length&&ap.substr(ap.length-1,1)==="/"){az=at.parentNode;if(aB===at.namespaces){av()}ap=ap.substr(0,ap.length-1)}var ax,ar;var ad=/((([\w\-]+):)?([\w\-]+))\s*=\s*('([^']*)'|"([^"]*)")/g;while(ax=ad.exec(ap)){var ag=ax[3]||"",aq=ax[ax[6]?6:7];if(ax[1].indexOf("xmlns")){if(!at.attributes){at.attributes=[]}ar={nodeType:2,prefix:ag,nodeName:ax[4],value:aq};an=(ag==="")?"":aB[ag];if(typeof(an)==="undefined"){throw'Unrecognized namespace with prefix "'+aw+'"'}ar.namespaceURI=an;at.attributes.push(ar)}else{if(!ay){af()}aB[ax[3]?ax[4]:""]=aq}}ad.lastIndex=0}aw=ai[4]||"";at.prefix=aw;an=aB[aw];if(typeof(an)==="undefined"){throw'Unrecognized namespace with prefix "'+aw+'"'}at.namespaceURI=an}else{if(am=ai[10]){au=ai[9]||"";if(aj.nodeName===am&&aj.prefix===au){az=aj.parentNode;if(aB===aj.namespaces){av()}}else{throw"Unclosed tag "+au+":"+am}}else{if(ae=ai[11]){at={offset:ai.index,parentNode:aj,target:ae,data:ai[12],nodeType:7}}else{if(ai[13]){at={offset:ai.index,parentNode:aj,nodeType:8,data:ai[14]}}else{if((al=ai[15])&&(!/^\s+$/.test(al))){at={offset:ai.index,parentNode:aj,nodeType:3,data:al}}}}}}if(at){if(!aj.childNodes){aj.childNodes=[]}aj.childNodes.push(at)}if(az){aj=az}}return aA}p=function(ad){this.listeners={};this.listeners[p.EVENT_REQUEST]=[];this.listeners[p.EVENT_SUCCESS]=[];this.listeners[p.EVENT_ERROR]=[];this.listeners[p.EVENT_DISCOVER]=[];this.listeners[p.EVENT_DISCOVER_SUCCESS]=[];this.listeners[p.EVENT_DISCOVER_ERROR]=[];this.listeners[p.EVENT_EXECUTE]=[];this.listeners[p.EVENT_EXECUTE_SUCCESS]=[];this.listeners[p.EVENT_EXECUTE_ERROR]=[];this.options=g(g({},p.defaultOptions,true),ad,true);var ae=this.options.listeners;if(ae){this.addListener(ae)}return this};p.defaultOptions={requestTimeout:30000,async:false,addFieldGetters:true,forceResponseXMLEmulation:false};p.METHOD_DISCOVER="Discover";p.METHOD_EXECUTE="Execute";var Q="DISCOVER_";var d="MDSCHEMA_";var y="DBSCHEMA_";p.DISCOVER_DATASOURCES=Q+"DATASOURCES";p.DISCOVER_PROPERTIES=Q+"PROPERTIES";p.DISCOVER_SCHEMA_ROWSETS=Q+"SCHEMA_ROWSETS";p.DISCOVER_ENUMERATORS=Q+"ENUMERATORS";p.DISCOVER_KEYWORDS=Q+"KEYWORDS";p.DISCOVER_LITERALS=Q+"LITERALS";p.DBSCHEMA_CATALOGS=y+"CATALOGS";p.DBSCHEMA_COLUMNS=y+"COLUMNS";p.DBSCHEMA_PROVIDER_TYPES=y+"PROVIDER_TYPES";p.DBSCHEMA_SCHEMATA=y+"SCHEMATA";p.DBSCHEMA_TABLES=y+"TABLES";p.DBSCHEMA_TABLES_INFO=y+"TABLES_INFO";p.MDSCHEMA_ACTIONS=d+"ACTIONS";p.MDSCHEMA_CUBES=d+"CUBES";p.MDSCHEMA_DIMENSIONS=d+"DIMENSIONS";p.MDSCHEMA_FUNCTIONS=d+"FUNCTIONS";p.MDSCHEMA_HIERARCHIES=d+"HIERARCHIES";p.MDSCHEMA_LEVELS=d+"LEVELS";p.MDSCHEMA_MEASURES=d+"MEASURES";p.MDSCHEMA_MEMBERS=d+"MEMBERS";p.MDSCHEMA_PROPERTIES=d+"PROPERTIES";p.MDSCHEMA_SETS=d+"SETS";p.EVENT_REQUEST="request";p.EVENT_SUCCESS="success";p.EVENT_ERROR="error";p.EVENT_EXECUTE="execute";p.EVENT_EXECUTE_SUCCESS="executesuccess";p.EVENT_EXECUTE_ERROR="executeerror";p.EVENT_DISCOVER="discover";p.EVENT_DISCOVER_SUCCESS="discoversuccess";p.EVENT_DISCOVER_ERROR="discovererror";p.EVENT_GENERAL=[p.EVENT_REQUEST,p.EVENT_SUCCESS,p.EVENT_ERROR];p.EVENT_DISCOVER_ALL=[p.EVENT_DISCOVER,p.EVENT_DISCOVER_SUCCESS,p.EVENT_DISCOVER_ERROR];p.EVENT_EXECUTE_ALL=[p.EVENT_EXECUTE,p.EVENT_EXECUTE_SUCCESS,p.EVENT_EXECUTE_ERROR];p.EVENT_ALL=[].concat(p.EVENT_GENERAL,p.EVENT_DISCOVER_ALL,p.EVENT_EXECUTE_ALL);p.PROP_DATASOURCEINFO="DataSourceInfo";p.PROP_CATALOG="Catalog";p.PROP_CUBE="Cube";p.PROP_FORMAT="Format";p.PROP_FORMAT_TABULAR="Tabular";p.PROP_FORMAT_MULTIDIMENSIONAL="Multidimensional";p.PROP_AXISFORMAT="AxisFormat";p.PROP_AXISFORMAT_TUPLE="TupleFormat";p.PROP_AXISFORMAT_CLUSTER="ClusterFormat";p.PROP_AXISFORMAT_CUSTOM="CustomFormat";p.PROP_CONTENT="Content";p.PROP_CONTENT_DATA="Data";p.PROP_CONTENT_NONE="None";p.PROP_CONTENT_SCHEMA="Schema";p.PROP_CONTENT_SCHEMADATA="SchemaData";p.prototype={listeners:null,soapMessage:null,response:null,responseText:null,responseXML:null,getResponseXML:function(){if(u(this.responseXML)){return this.responseXML}return(this.responseXML=w(this.responseText))},setOptions:function(ad){g(this.options,ad,true)},addListener:function(){var ak=arguments.length,ai,ah;switch(ak){case 0:p.Exception._newError("NO_EVENTS_SPECIFIED","Xmla.addListener",null)._throw();case 1:var ae=arguments[0];if(u(ae)){var ag;if(K(ae)){this._addListeners(ae)}else{if(ag=ae.events||ae.event){if(W(ag)){ag=(ag==="all")?p.EVENT_ALL:ag.split(",")}if(!(K(ag))){p.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",ae)._throw()}var af;ak=ag.length;for(af=0;af<ak;af++){this._addListener(ag[af],ae)}}else{ah=ae.scope;if(R(ah)){ah=null}else{delete ae.scope}for(ag in ae){ai=ae[ag];if(R(ai.scope)){ai.scope=ah}this._addListener(ag,ai)}}}}else{p.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",ae)._throw()}break;case 2:case 3:var aj=arguments[0];ah=arguments[2];ai=arguments[1];if(W(aj)&&(f(ai)||(u(ai)))){this._addListener(aj,ai,ah)}else{var ad=[aj,ai];if(ah){ad.push(ah)}this.addListener(ad)}break;default:this._addListeners(arguments)}},_addListeners:function(ae){var ad,af=ae.length;for(ad=0;ad<af;ad++){this.addListener(ae[ad])}},_addListener:function(ae,ai,ah){var ag=this.listeners[ae];if(!ag){p.Exception._newError("UNKNOWN_EVENT","Xmla.addListener",{event:ae,handler:ai,scope:ah})._throw()}if(!ah){ah=null}switch(typeof(ai)){case"function":ag.push({handler:ai,scope:ah});break;case"object":var ad=ai.handler||ai.handlers;if(ai.scope){ah=ai.scope}if(f(ad)){ag.push({handler:ad,scope:ah})}else{if(K(ad)){var af,aj=ad.length;for(af=0;af<aj;af++){this._addListener(ae,ad[af],ah)}}}break}},_fireEvent:function(ai,al,ae){var aj=this.listeners[ai];if(!aj){p.Exception._newError("UNKNOWN_EVENT","Xmla._fireEvent",ai)._throw()}var af=aj.length,ad=true;if(af){var ag,ak,ah;for(ah=0;ah<af;ah++){ag=aj[ah];ak=ag.handler.call(ag.scope,ai,al,this);if(ae&&ak===false){ad=false;break}}}else{if(ai===p.EVENT_ERROR&&!f(al.error)&&!f(al.callback)){al.exception._throw()}}return ad},getXmlaSoapMessage:function b(ad){var af=ad.method,ae='<?xml version="1.0" encoding="UTF-8"?>\n<'+Z+":Envelope "+J+" "+o+">\n <"+Z+":Body>\n  <"+af+" "+L+" "+o+">";switch(af){case p.METHOD_DISCOVER:if(!ad.requestType){p.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",ad)._throw()}ae+="\n   <"+c+">"+ad.requestType+"</"+c+">"+G("Restrictions","RestrictionList",ad.restrictions,"   ")+G("Properties","PropertyList",ad.properties,"   ");break;case p.METHOD_EXECUTE:if(!ad.statement){p.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",ad)._throw()}ae+="\n   <Command>\n    <Statement>"+r(ad.statement)+"</Statement>\n   </Command>"+G("Properties","PropertyList",ad.properties,"   ");break;default:}ae+="\n  </"+af+">\n </"+Z+":Body>\n</"+Z+":Envelope>";return ae},request:function(ae){var ag,af=this;this.response=null;this.responseText=null;this.responseXML=null;ae=g(ae,this.options,false);if(!ae.url){ag=p.Exception._newError("MISSING_URL","Xmla.request",ae);ag._throw()}ae.properties=g(ae.properties,this.options.properties,false);ae.restrictions=g(ae.restrictions,this.options.restrictions,false);var ah=this.getXmlaSoapMessage(ae);this.soapMessage=ah;var ai;var ad={async:ae.async,timeout:ae.requestTimeout,data:ah,error:function(aj){ae.exception=aj;af._requestError(ae,aj)},complete:function(aj){ae.xhr=aj;af._requestSuccess(ae)},url:ae.url};if(ae.username){ad.username=ae.username}if(ae.password){ad.password=ae.password}if(ae.headers){ad.headers=ae.headers}if(this._fireEvent(p.EVENT_REQUEST,ae,true)&&((ae.method==p.METHOD_DISCOVER&&this._fireEvent(p.EVENT_DISCOVER,ae))||(ae.method==p.METHOD_EXECUTE&&this._fireEvent(p.EVENT_EXECUTE,ae)))){ai=N(ad)}return this.response},_requestError:function(ad,ae){if(ad.error){ad.error.call(ad.scope?ad.scope:null,this,ad,ae)}if(ad.callback){ad.callback.call(ad.scope?ad.scope:null,p.EVENT_ERROR,this,ad,ae)}this._fireEvent(p.EVENT_ERROR,ad)},_requestSuccess:function(aj){var am=aj.xhr,ah;if(aj.forceResponseXMLEmulation!==true){this.responseXML=am.responseXML}this.responseText=am.responseText;var ad=aj.method;try{var ag=this.getResponseXML();var ae=Y(ag,ac,Z,"Fault");if(ae.length){ae=ae[0];aj.exception=new p.Exception(p.Exception.TYPE_ERROR,V(ae,"faultcode")[0].childNodes[0].data,V(ae,"faultstring")[0].childNodes[0].data,null,"_requestSuccess",aj)}else{switch(ad){case p.METHOD_DISCOVER:aj.rowset=ah=new p.Rowset(ag,aj.requestType,this);break;case p.METHOD_EXECUTE:var ak=null,ai=null;var al=aj.properties[p.PROP_FORMAT];switch(al){case p.PROP_FORMAT_TABULAR:ah=ak=new p.Rowset(ag,null,this);break;case p.PROP_FORMAT_MULTIDIMENSIONAL:ah=ai=new p.Dataset(ag);break}aj.resultset=ak;aj.dataset=ai;break}this.response=ah}}catch(af){aj.exception=af}if(aj.exception){switch(ad){case p.METHOD_DISCOVER:this._fireEvent(p.EVENT_DISCOVER_ERROR,aj);break;case p.METHOD_EXECUTE:this._fireEvent(p.EVENT_EXECUTE_ERROR,aj);break}if(aj.error){aj.error.call(aj.scope?aj.scope:null,this,aj,aj.exception)}if(aj.callback){aj.callback.call(aj.scope?aj.scope:null,p.EVENT_ERROR,this,aj,aj.exception)}this._fireEvent(p.EVENT_ERROR,aj)}else{switch(ad){case p.METHOD_DISCOVER:this._fireEvent(p.EVENT_DISCOVER_SUCCESS,aj);break;case p.METHOD_EXECUTE:this._fireEvent(p.EVENT_EXECUTE_SUCCESS,aj);break}if(aj.success){aj.success.call(aj.scope?aj.scope:null,this,aj,ah)}if(aj.callback){aj.callback.call(aj.scope?aj.scope:null,p.EVENT_SUCCESS,this,aj,ah)}this._fireEvent(p.EVENT_SUCCESS,aj)}},execute:function(ad){var ae=ad.properties;if(!ae){ae={};ad.properties=ae}g(ae,this.options.properties,false);if(!ae[p.PROP_CONTENT]){ae[p.PROP_CONTENT]=p.PROP_CONTENT_SCHEMADATA}if(!ae[p.PROP_FORMAT]){ad.properties[p.PROP_FORMAT]=p.PROP_FORMAT_MULTIDIMENSIONAL}var af=g(ad,{method:p.METHOD_EXECUTE},true);return this.request(af)},executeTabular:function(ad){if(!ad.properties){ad.properties={}}ad.properties[p.PROP_FORMAT]=p.PROP_FORMAT_TABULAR;return this.execute(ad)},executeMultiDimensional:function(ad){if(!ad.properties){ad.properties={}}ad.properties[p.PROP_FORMAT]=p.PROP_FORMAT_MULTIDIMENSIONAL;return this.execute(ad)},discover:function(ad){var ae=g(ad,{method:p.METHOD_DISCOVER},true);if(!ae.requestType){ae.requestType=this.options.requestType}return this.request(ae)},discoverDataSources:function(ad){var ae=g(ad,{requestType:p.DISCOVER_DATASOURCES},true);return this.discover(ae)},discoverProperties:function(ad){var ae=g(ad,{requestType:p.DISCOVER_PROPERTIES},true);return this.discover(ae)},discoverSchemaRowsets:function(ad){var ae=g(ad,{requestType:p.DISCOVER_SCHEMA_ROWSETS},true);return this.discover(ae)},discoverEnumerators:function(ad){var ae=g(ad,{requestType:p.DISCOVER_ENUMERATORS},true);return this.discover(ae)},discoverKeywords:function(ad){var ae=g(ad,{requestType:p.DISCOVER_KEYWORDS},true);return this.discover(ae)},discoverLiterals:function(ad){var ae=g(ad,{requestType:p.DISCOVER_LITERALS},true);return this.discover(ae)},discoverDBCatalogs:function(ad){var ae=g(ad,{requestType:p.DBSCHEMA_CATALOGS},true);return this.discover(ae)},discoverDBColumns:function(ad){var ae=g(ad,{requestType:p.DBSCHEMA_COLUMNS},true);return this.discover(ae)},discoverDBProviderTypes:function(ad){var ae=g(ad,{requestType:p.DBSCHEMA_PROVIDER_TYPES},true);return this.discover(ae)},discoverDBSchemata:function(ad){var ae=g(ad,{requestType:p.DBSCHEMA_SCHEMATA},true);return this.discover(ae)},discoverDBTables:function(ad){var ae=g(ad,{requestType:p.DBSCHEMA_TABLES},true);return this.discover(ae)},discoverDBTablesInfo:function(ad){var ae=g(ad,{requestType:p.DBSCHEMA_TABLES_INFO},true);return this.discover(ae)},discoverMDActions:function(ad){var ae=g(ad,{requestType:p.MDSCHEMA_ACTIONS},true);return this.discover(ae)},discoverMDCubes:function(ad){var ae=g(ad,{requestType:p.MDSCHEMA_CUBES},true);return this.discover(ae)},discoverMDDimensions:function(ad){var ae=g(ad,{requestType:p.MDSCHEMA_DIMENSIONS},true);return this.discover(ae)},discoverMDFunctions:function(ad){var ae=g(ad,{requestType:p.MDSCHEMA_FUNCTIONS},true);return this.discover(ae)},discoverMDHierarchies:function(ad){var ae=g(ad,{requestType:p.MDSCHEMA_HIERARCHIES},true);return this.discover(ae)},discoverMDLevels:function(ad){var ae=g(ad,{requestType:p.MDSCHEMA_LEVELS},true);return this.discover(ae)},discoverMDMeasures:function(ad){var ae=g(ad,{requestType:p.MDSCHEMA_MEASURES},true);return this.discover(ae)},discoverMDMembers:function(ad){var ae=g(ad,{requestType:p.MDSCHEMA_MEMBERS},true);return this.discover(ae)},discoverMDProperties:function(ad){var ae=g(ad,{requestType:p.MDSCHEMA_PROPERTIES},true);return this.discover(ae)},discoverMDSets:function(ad){var ae=g(ad,{requestType:p.MDSCHEMA_SETS},true);return this.discover(ae)}};function E(ai,ad){var af=Y(ai,v,B,"complexType"),ah=af.length,ag,ae;for(ae=0;ae<ah;ae++){ag=af[ae];if(m(ag,"name")===ad){return ag}}return null}p.Rowset=function(af,ad,ae){this._node=af;this._type=ad;this._xmla=ae;this._initData();return this};p.Rowset.MD_DIMTYPE_UNKNOWN=0;p.Rowset.MD_DIMTYPE_TIME=1;p.Rowset.MD_DIMTYPE_MEASURE=2;p.Rowset.MD_DIMTYPE_OTHER=3;p.Rowset.MD_DIMTYPE_QUANTITATIVE=5;p.Rowset.MD_DIMTYPE_ACCOUNTS=6;p.Rowset.MD_DIMTYPE_CUSTOMERS=7;p.Rowset.MD_DIMTYPE_PRODUCTS=8;p.Rowset.MD_DIMTYPE_SCENARIO=9;p.Rowset.MD_DIMTYPE_UTILIY=10;p.Rowset.MD_DIMTYPE_CURRENCY=11;p.Rowset.MD_DIMTYPE_RATES=12;p.Rowset.MD_DIMTYPE_CHANNEL=13;p.Rowset.MD_DIMTYPE_PROMOTION=14;p.Rowset.MD_DIMTYPE_ORGANIZATION=15;p.Rowset.MD_DIMTYPE_BILL_OF_MATERIALS=16;p.Rowset.MD_DIMTYPE_GEOGRAPHY=17;p.Rowset.MD_STRUCTURE_FULLYBALANCED=0;p.Rowset.MD_STRUCTURE_RAGGEDBALANCED=1;p.Rowset.MD_STRUCTURE_UNBALANCED=2;p.Rowset.MD_STRUCTURE_NETWORK=3;p.Rowset.MD_USER_DEFINED=1;p.Rowset.MD_SYSTEM_ENABLED=2;p.Rowset.MD_SYSTEM_INTERNAL=4;p.Rowset.MDMEMBER_TYPE_REGULAR=1;p.Rowset.MDMEMBER_TYPE_ALL=2;p.Rowset.MDMEMBER_TYPE_FORMULA=3;p.Rowset.MDMEMBER_TYPE_MEASURE=4;p.Rowset.MDMEMBER_TYPE_UNKNOWN=0;p.Rowset.KEYS={};p.Rowset.KEYS[p.DBSCHEMA_CATALOGS]=["CATALOG_NAME"];p.Rowset.KEYS[p.DBSCHEMA_COLUMNS]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME","COLUMN_NAME"];p.Rowset.KEYS[p.DBSCHEMA_PROVIDER_TYPES]=["TYPE_NAME"];p.Rowset.KEYS[p.DBSCHEMA_SCHEMATA]=["CATALOG_NAME","SCHEMA_NAME"];p.Rowset.KEYS[p.DBSCHEMA_TABLES]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME"];p.Rowset.KEYS[p.DBSCHEMA_TABLES_INFO]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME"];p.Rowset.KEYS[p.DISCOVER_DATASOURCES]=["DataSourceName"];p.Rowset.KEYS[p.DISCOVER_ENUMERATORS]=["EnumName","ElementName"];p.Rowset.KEYS[p.DISCOVER_KEYWORDS]=["Keyword"];p.Rowset.KEYS[p.DISCOVER_LITERALS]=["LiteralName"];p.Rowset.KEYS[p.DISCOVER_PROPERTIES]=["PropertyName"];p.Rowset.KEYS[p.DISCOVER_SCHEMA_ROWSETS]=["SchemaName"];p.Rowset.KEYS[p.MDSCHEMA_ACTIONS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","ACTION_NAME"];p.Rowset.KEYS[p.MDSCHEMA_CUBES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME"];p.Rowset.KEYS[p.MDSCHEMA_DIMENSIONS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME"];p.Rowset.KEYS[p.MDSCHEMA_FUNCTIONS]=["FUNCTION_NAME","PARAMETER_LIST"];p.Rowset.KEYS[p.MDSCHEMA_HIERARCHIES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME"];p.Rowset.KEYS[p.MDSCHEMA_LEVELS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME"];p.Rowset.KEYS[p.MDSCHEMA_MEASURES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","MEASURE_NAME"];p.Rowset.KEYS[p.MDSCHEMA_MEMBERS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME","MEMBER_UNIQUE_NAME"];p.Rowset.KEYS[p.MDSCHEMA_PROPERTIES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME","MEMBER_UNIQUE_NAME","PROPERTY_NAME"];p.Rowset.KEYS[p.MDSCHEMA_SETS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","SET_NAME"];function P(ad){return ad==="true"?true:false}P.jsType="boolean";function t(ad){return parseInt(ad,10)}t.jsType="number";function C(ad){return parseFloat(ad,10)}C.jsType="number";function F(ad){return ad}F.jsType="string";function s(ad){return Date.parse(ad)}s.jsType="object";function e(ad){return ad}e.jsType="object";function O(af,ae){var ad=[],ai=af.length,ag,ah;for(ag=0;ag<ai;ag++){ah=af[ag];ad.push(ae(x(ah)))}return ad}O.jsType="object";var a={"xsd:boolean":P,"xsd:decimal":C,"xsd:double":C,"xsd:float":C,"xsd:int":t,"xsd:integer":t,"xsd:nonPositiveInteger":t,"xsd:negativeInteger":t,"xsd:nonNegativeInteger":t,"xsd:positiveInteger":t,"xsd:short":t,"xsd:byte":t,"xsd:long":t,"xsd:unsignedLong":t,"xsd:unsignedInt":t,"xsd:unsignedShort":t,"xsd:unsignedByte":t,"xsd:string":F,"xsd:dateTime":s,Restrictions:e};function S(ad){var ae;return(ae=a[ad])?ae:F}function M(ag){var ad=x(ag),af=T(ag,aa,X,"type"),ae;if(af){ae=a[af];if(ae){return ae(ad)}}return ad}function z(ad){return"get"+(/^[A-Z]+[a-z]+[A-Za-z]*$/g.test(ad)?ad:ad.charAt(0).toUpperCase()+ad.substr(1).toLowerCase().replace(/_[a-z]/g,function(ae){return ae.charAt(1).toUpperCase()}))}p.Rowset.prototype={_node:null,_type:null,_row:null,_rows:null,numRows:null,fieldOrder:null,fields:null,_fieldCount:null,_initData:function(){this._rows=Y(this._node,D,null,"row");this.numRows=this._rows?this._rows.length:0;this.reset();this.fieldOrder=[];this.fields={};this._fieldCount=0;var al=E(this._node,"row");if(al){var ar=Y(al,v,B,"sequence")[0],ai=ar.childNodes,ak=ai?ai.length:0,ap,ae,aq,am,ah,ao,af,an,ad=this._xmla.options.addFieldGetters,aj,ag;for(aj=0;aj<ak;aj++){ap=ai[aj];if(ap.nodeType!==1){continue}ae=T(ap,h,n,"field");aq=m(ap,"name");ao=m(ap,"type");if(ao===null&&this._row){ag=V(this._row,aq);if(ag.length){ao=T(ag[0],aa,X,"type")}}if(!ao&&this._type==p.DISCOVER_SCHEMA_ROWSETS&&aq==="Restrictions"){ao="Restrictions"}am=m(ap,"minOccurs");if(am){am=parseInt(am,10)}else{am=1}ah=m(ap,"maxOccurs");if(ah){if(ah==="unbounded"){ah=Infinity}else{am=parseInt(ah,10)}}else{ah=1}af=S(ao);an=this._createFieldGetter(aq,af,am,ah);if(ad){this[z(aq)]=an}this.fields[ae]={name:aq,label:ae,index:this._fieldCount++,type:ao,jsType:af.jsType,minOccurs:am,maxOccurs:ah,getter:an};this.fieldOrder.push(ae)}}else{p.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",this._node)._throw()}},_createFieldGetter:function(ah,ae,ag,af){var ad;if(af===1){if(ag===1){ad=function(){var ai=Y(this._row,D,null,ah);return ae(x(ai[0]))}}else{if(ag===0){ad=function(){var ai=Y(this._row,D,null,ah);if(ai.length){return ae(x(ai[0]))}else{return null}}}}}else{if(ag===1){ad=function(){var ai=Y(this._row,D,null,ah);return O(ai,ae)}}else{if(ag===0){ad=function(){var ai=Y(this._row,D,null,ah);if(ai.length){return O(ai,ae)}else{return null}}}}}return ad},getType:function(){return this._type},getFields:function(){var af=[],ae,ag=this._fieldCount,ad=this.fieldOrder;for(ae=0;ae<ag;ae++){af[ae]=this.fieldDef(ad[ae])}return af},getFieldNames:function(){var ae=[],ad,af=this._fieldCount;for(ad=0;ad<af;ad++){ae[ad]=this.fieldOrder[ad]}return ae},hasMoreRows:function(){return this.numRows>this.rowIndex},nextRow:function(){this.rowIndex++;this._row=this._rows[this.rowIndex];return this.rowIndex},next:function(){return this.nextRow()},eachRow:function(ag,af,ad){if(R(af)){af=this}var ae=[null];if(!R(ad)){if(!K(ad)){ad=[ad]}ae=ae.concat(ad)}while(this.hasMoreRows()){ae[0]=this.readAsObject();if(ag.apply(af,ae)===false){return false}this.nextRow()}return true},currRow:function(){return this.rowIndex},rowCount:function(){return this.numRows},reset:function(){this.rowIndex=0;this._row=(this.hasMoreRows())?this._rows[this.rowIndex]:null},fieldDef:function(ad){var ae=this.fields[ad];if(!ae){p.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",ad)._throw()}return ae},fieldIndex:function(ad){return this.fieldDef(ad).index},fieldName:function(ad){var ae=this.fieldOrder[ad];if(!ae){p.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",ad)._throw()}return ae},fieldVal:function(ad){if(i(ad)){ad=this.fieldName(ad)}return this.fieldDef(ad).getter.call(this)},fieldCount:function(){return this._fieldCount},close:function(){this._node=null;this._row=null;this._rows=null},readAsArray:function(ag){var ad=this.fields,af,ae;if(!ag){ag=[]}for(af in ad){if(ad.hasOwnProperty(af)){ae=ad[af];ag[ae.index]=ae.getter.call(this)}}return ag},fetchAsArray:function(ad){if(this.hasMoreRows()){ad=this.readAsArray(ad);this.nextRow()}else{ad=false}return ad},readAsObject:function(ae){var ad=this.fields,ag,af;if(!ae){ae={}}for(ag in ad){if(ad.hasOwnProperty(ag)){af=ad[ag];ae[ag]=af.getter.call(this)}}return ae},fetchAsObject:function(ad){if(this.hasMoreRows()){ad=this.readAsObject(ad);this.nextRow()}else{ad=false}return ad},fetchCustom:function(af,ae){var ad;if(this.hasMoreRows()){ad=af.call(this,ae);this.nextRow()}else{ad=false}return ad},fetchAllAsArray:function(ad){var ae;if(!ad){ad=[]}while((ae=this.fetchAsArray())){ad.push(ae)}return ad},fetchAllAsObject:function(ad){var ae;if(!ad){ad=[]}while((ae=this.fetchAsObject())){ad.push(ae)}return ad},fetchAllCustom:function(af,ae,ad){var ag;if(!af){af=[]}while((ag=this.fetchCustom(ae,ad))){af.push(ag)}return af},mapAsObject:function(ad,ak,am){var ag,al,ae,ah,ai=ak.length,aj=ai-1,af=ad;for(ah=0;ah<ai;ah++){ag=ak[ah];al=am[ag];ae=af[al];if(ae){if(ah===aj){if(K(ae)){ae.push(am)}else{af[al]=[ae,am]}}else{af=ae}}else{if(ah===aj){af[al]=am}else{af=af[al]={}}}}},mapAllAsObject:function(ad,ae){if(!ae){ae={}}if(!ad){ad=this.getKey()}var af;while(af=this.fetchAsObject()){this.mapAsObject(ae,ad,af)}return ae},getKey:function(){return(this._type)?p.Rowset.KEYS[this._type]:this.getFieldNames()}};p.Dataset=function(ad){this._initDataset(ad);return this};p.Dataset.AXIS_COLUMNS=0;p.Dataset.AXIS_ROWS=1;p.Dataset.AXIS_PAGES=2;p.Dataset.AXIS_SECTIONS=3;p.Dataset.AXIS_CHAPTERS=4;p.Dataset.AXIS_SLICER="SlicerAxis";p.Dataset.prototype={_root:null,_axes:null,_axesOrder:null,_numAxes:null,_slicer:null,_cellset:null,_initDataset:function(aj){this._initRoot(aj);this.cubeName=x(Y(this._root,ab,"","CubeName")[0]);this._initAxes();this._initCells();var ad,af,ae,ah,ag="",ai;ah="var ordinal = 0, a;\nif (arguments.length !== "+this._numAxes+') new Xmla.Exception._newError("ERROR_ILLEGAL_ARGUMENT", "cellOrdinalForTupleIndexes", this)._throw();';for(ad=0,af=this._numAxes-1;af>=0;af--,ad++){ah+="\nif (typeof(a = arguments["+ad+'])!=="number") new Xmla.Exception._newError("ERROR_ILLEGAL_ARGUMENT", "cellOrdinalForTupleIndexes", this)._throw();';ai=1;for(ae=af-1;ae>=0;ae--){ai*=this._axesOrder[ae].tupleCount()}ah+="\nordinal += a ";if(af){ah+="* "+ai+";"}}ah+=ag+"\nreturn ordinal;";this._cellset.cellOrdinalForTupleIndexes=this.cellOrdinalForTupleIndexes=new Function(ah)},_initRoot:function(ae){var ad=Y(ae,ab,"","root");if(ad.length){this._root=ad[0]}else{p.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Dataset._initData",ae)._throw()}},_initAxes:function(){var ag,ah,ae,aj,af,ad,ai={};this._axes={};this._axesOrder=[];af=Y(this._root,ab,"","AxisInfo");ad=af.length;for(ag=0;ag<ad;ag++){ae=af[ag];aj=m(ae,"name");ai[aj]=ae}af=Y(this._root,ab,"","Axis");ad=af.length;for(ag=0;ag<ad;ag++){ae=af[ag];aj=m(ae,"name");ah=new p.Dataset.Axis(this,ai[aj],ae,aj,ag);if(aj===p.Dataset.AXIS_SLICER){this._slicer=ah}else{this._axes[aj]=ah;this._axesOrder.push(ah)}}this._numAxes=this._axesOrder.length},_initCells:function(){this._cellset=new p.Dataset.Cellset(this)},axisCount:function(){return this._numAxes},_getAxis:function(ad){var ae,af;switch(typeof(ad)){case"number":af=this._axesOrder[ad];break;case"string":af=(ae===p.Dataset.AXIS_SLICER)?this._slicer:this._axes[ae];break}return af},getAxis:function(ad){if(ad===p.Dataset.AXIS_SLICER){return this._slicer}var ae=this._getAxis(ad);if(!ae){p.Exception._newError("INVALID_AXIS","Xmla.Dataset.getAxis",ad)._throw()}return ae},hasAxis:function(ad){var ae=this._getAxis(ad);return !R(ae)},getColumnAxis:function(){return this.getAxis(p.Dataset.AXIS_COLUMNS)},hasColumnAxis:function(){return this.hasAxis(p.Dataset.AXIS_COLUMNS)},getRowAxis:function(){return this.getAxis(p.Dataset.AXIS_ROWS)},hasRowAxis:function(){return this.hasAxis(p.Dataset.AXIS_ROWS)},getPageAxis:function(){return this.getAxis(p.Dataset.AXIS_PAGES)},hasPageAxis:function(){return this.hasAxis(p.Dataset.AXIS_PAGES)},getSectionAxis:function(){return this.getAxis(p.Dataset.AXIS_SECTIONS)},hasSectionAxis:function(){return this.hasAxis(p.Dataset.AXIS_SECTIONS)},getChapterAxis:function(){return this.getAxis(p.Dataset.AXIS_CHAPTERS)},hasChapterAxis:function(){return this.hasAxis(p.Dataset.AXIS_CHAPTERS)},getSlicerAxis:function(){return this._slicer},hasSlicerAxis:function(){return this._slicer!==null},getCellset:function(){return this._cellset},cellOrdinalForTupleIndexes:function(){throw"Not implemented"},fetchAsObject:function(){var ai=[],ah,ae,aj=[],af=[],ad,ag,ak;for(ag=0,ak=this.axisCount();ag<ak;ag++){ah=this.getAxis(ag);ai.push({positions:ah.fetchAllAsObject(),hierarchies:ah.getHierarchies()})}ae=(ah=this.getSlicerAxis())?{positions:ah.fetchAllAsObject(),hierarchies:ah.getHierarchies()}:null;aj=this.getCellset();for(ag=0,ak=aj.cellCount();ag<ak;ag++){ad=aj.readCell();af.push(ad);aj.nextCell()}aj.close();return{axes:ai,slicerAxis:ae,cells:af}},close:function(){if(this._slicer){this._slicer.close()}var ad,ae=this._numAxes;for(ad=0;ad<ae;ad++){this.getAxis(ad).close()}this._cellset.close();this._root=null;this._axes=null;this._axesOrder=null;this._numAxes=null;this._slicer=null}};p.Dataset.Axis=function(af,ah,ad,ae,ag){this._dataset=af;this._initAxis(ah,ad);this.name=ae;this.id=ag;return this};p.Dataset.Axis.MEMBER_UNIQUE_NAME="UName";p.Dataset.Axis.MEMBER_CAPTION="Caption";p.Dataset.Axis.MEMBER_LEVEL_NAME="LName";p.Dataset.Axis.MEMBER_LEVEL_NUMBER="LNum";p.Dataset.Axis.MEMBER_DISPLAY_INFO="DisplayInfo";p.Dataset.Axis.MDDISPINFO_CHILDREN_CARDINALITY=65535;p.Dataset.Axis.MDDISPINFO_DRILLED_DOWN=65536;p.Dataset.Axis.MDDISPINFO_SAME_PARENT_AS_PREV=131072;p.Dataset.Axis.prototype={_dataset:null,_tuples:null,_members:null,_memberProperties:null,numTuples:null,numHierarchies:null,_tupleIndex:null,_hierarchyIndex:null,_hierarchyOrder:null,_hierarchyDefs:null,_hierarchyIndexes:null,_initHierarchies:function(ad){var an=Y(ad,ab,"","HierarchyInfo"),ai=an.length,ag,ae,aq,ah,ak,af,aj,ao,ap,am,al=this._memberProperties;this._hierarchyDefs={};this._hierarchyOrder=[];this._hierarchyIndexes={};this.numHierarchies=ai;for(ag=0;ag<ai;ag++){aq=an[ag];ah=m(aq,"name");this._hierarchyOrder[ag]=ah;this._hierarchyIndexes[ah]=ag;ak={index:ag,name:ah};aj=Y(aq,ab,"","*");af=aj.length;for(ae=0;ae<af;ae++){ao=aj[ae];ap=ao.nodeName;ak[ap]=null;if(al[ap]){continue}am=m(ao,"type");al[ap]={converter:a[am],name:A(ap)}}this._hierarchyDefs[ah]=ak}},_initMembers:function(){var al=this._dataset._root,ag,ae,ah,af,ak,ad,ai,aj=this._memberProperties={};ag=E(al,"MemberType");if(!ag){p.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.DataSet.Axis",al)._throw()}ag=Y(ag,v,B,"sequence")[0],ae=Y(ag,v,B,"element");ah=ae.length;for(ai=0;ai<ah;ai++){af=ae[ai];ak=m(af,"type");ad=m(af,"name");aj[ad]={converter:a[ak],name:A(ad)}}},_initAxis:function(ae,ad){this.name=m(ad,"name");this._initMembers();this._initHierarchies(ae);this._tuples=Y(ad,ab,"","Tuple");this.numTuples=this._tuples.length;this.reset()},close:function(){this.numTuples=-1;this._tuples=null;this._hierarchyDefs=null;this._hierarchyOrder=null;this._hierarchyIndexes=null;this._members=null},_getMembers:function(){if(!this.hasMoreTuples()){return null}return Y(this._tuples[this._tupleIndex],ab,"","Member")},reset:function(){this._hierarchyIndex=0;this._tupleIndex=0;this._members=this._getMembers()},hasMoreHierarchies:function(){return this.numHierarchies>this._hierarchyIndex},nextHierarchy:function(){return this._hierarchyIndex++},eachHierarchy:function(ag,af,ad){var ae=[null];if(!af){af=this}if(ad){if(!K(ad)){ad=[ad]}ae=ae.concat(ad)}while(this.hasMoreHierarchies()){ae[0]=this._hierarchyDefs[this._hierarchyOrder[this._hierarchyIndex]];if(ag.apply(af,ae)===false){return false}this.nextHierarchy()}this._hierarchyIndex=0;return true},hasMoreTuples:function(){return this.numTuples>this._tupleIndex},nextTuple:function(){this._tupleIndex++;this._members=this._getMembers();return this._tupleIndex},tupleCount:function(){return this.numTuples},tupleIndex:function(){return this._tupleIndex},getTuple:function(){var ag,ah=this.numHierarchies,ae={},af=[],ad={index:this._tupleIndex,hierarchies:ae,members:af};for(ag=0;ag<ah;ag++){af.push(ae[this._hierarchyOrder[ag]]=this._member(ag))}return ad},eachTuple:function(ag,af,ad){var ae=[null];if(!af){af=this}if(ad){if(K(ad)){ae.concat(ad)}else{ae.push(ad)}}while(this.hasMoreTuples()){ae[0]=this.getTuple();if(ag.apply(af,ae)===false){return false}this.nextTuple()}this._tupleIndex=0;this._members=this._getMembers();return true},getHierarchies:function(){return this._hierarchyDefs},getHierarchyNames:function(){var af=[],ad,ae=this.numHierarchies;for(ad=0;ad<ae;ad++){af[ad]=this._hierarchyOrder[ad]}return af},hierarchyCount:function(){return this.numHierarchies},hierarchyIndex:function(ad){if(R(ad)){return this._hierarchyIndex}var ae=this._hierarchyIndexes[ad];if(R(ae)){p.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",ad)._throw()}return ae},hierarchyName:function(ad){if(R(ad)){ad=this._hierarchyIndex}if(ad!==parseInt(ad,10)||ad>=this.numHierarchies){p.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",ad)._throw()}return this._hierarchyOrder[ad]},hierarchy:function(ag){if(R(ag)){af=this._hierarchyIndex}var af,ad,ae;if(i(ag)){if(ag!==parseInt(ag,10)||ag>=this.numHierarchies){p.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",ag)._throw()}ad=this.hierarchyName(ag)}else{ad=ag}ae=this._hierarchyDefs[ad];if(R(ae)){p.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",ad)._throw()}return ae},member:function(af){if(R(af)){ae=this._hierarchyIndex}var ae,ad;switch(typeof(af)){case"string":ae=this.hierarchyIndex(af);ad=af;break;case"number":if(af!==parseInt(af,10)||af>=this.numHierarchies){p.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",af)._throw()}ae=af;break}return this._member(ae)},_member:function(aj){var al=this._members[aj],an=al.childNodes,ah,af=an.length,ai=this.hierarchyName(aj),am,ag={index:aj,hierarchy:ai},ae,ak=this._memberProperties,ad;for(ah=0;ah<af;ah++){ae=an[ah];if(ae.nodeType!==1||(!(am=ak[ae.nodeName]))){continue}ag[am.name]=am.converter(x(ae))}return ag},hasMemberProperty:function(ad){return !R(this._memberProperties[ad])},readAsArray:function(af){if(!af){af=[]}var ad,ae=this.numHierarchies;for(ad=0;ad<ae;ad++){af[ad]=this._member(ad)}return af},readAsObject:function(ad){if(!ad){ad={}}var ae,af=this.numHierarchies;for(ae=0;ae<af;ae++){ad[this._hierarchyOrder[ae]]=this._member(ae)}return ad},fetchAsArray:function(ad){if(this.hasMoreTuples()){ad=this.readAsArray(ad);this.nextTuple()}else{ad=false}return ad},fetchAsObject:function(ad){if(this.hasMoreTuples(ad)){ad=this.readAsObject();this.nextTuple()}else{ad=false}return ad},fetchAllAsArray:function(ad){var ae;if(!ad){ad=[]}while((ae=this.fetchAsArray())){ad.push(ae)}return ad},fetchAllAsObject:function(ad){var ae;if(!ad){ad=[]}while((ae=this.fetchAsObject())){ad.push(ae)}return ad}};p.Dataset.Cellset=function(ad){this._dataset=ad;this._initCellset();return this};p.Dataset.Cellset.prototype={_dataset:null,_cellNodes:null,_cellCount:null,_cellNode:null,_cellProperties:null,_idx:null,_cellOrd:null,_initCellset:function(){var ao=this._dataset._root,ae,af,ak,ap,ag,ad,am,al,an,aq,aj,ai,ah;ae=E(ao,"CellData");if(!ae){p.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Dataset.Cellset",ao)._throw()}af=Y(ae,v,B,"element");ak=af.length;ag=Y(ao,ab,"","CellInfo");if(!ag||ag.length===0){p.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",ao)._throw()}ad=ag[0];al=Y(ad,ab,"","*");this._cellProperties={};aj=al.length;for(ai=0;ai<aj;ai++){an=al[ai];aq=an.nodeName;for(ah=0;ah<ak;ah++){ap=af[ah];if(m(ap,"name")!==aq){continue}am=m(ap,"type");this._cellProperties[aq]=a[am];this["cell"+aq]=new Function('return this.cellProperty("'+aq+'")');break}}this._cellNodes=Y(ao,ab,"","Cell");this._cellCount=this._cellNodes.length;this.reset()},_getCellNode:function(ad){if(!R(ad)){this._idx=ad}this._cellNode=this._cellNodes[this._idx];this._cellOrd=this._getCellOrdinal(this._cellNode)},_getCellOrdinal:function(ad){return parseInt(m(ad,"CellOrdinal"),10)},cellCount:function(){return this._cellNodes.length},reset:function(ad){this._idx=ad?ad:0;this._getCellNode()},hasMoreCells:function(){return this._idx<this._cellCount},nextCell:function(){this._idx+=1;if(this.hasMoreCells()){this._getCellNode();return this._cellOrd}else{this._idx=0;return -1}},curr:function(){return this._idx},hasCellProperty:function(ad){return !R(this._cellProperties[ad])},cellProperty:function(ae){var ah,af,ad,ag=Y(this._cellNode,ab,"",ae)[0];ah=M(ag);ad=this._cellProperties[ae];if(!ad){af=T(ag,aa,X,"type");ad=S(af)}return ad(ah)},cellOrdinal:function(){return this._cellOrd},_readCell:function(af,ad){var ah,ae,ag;for(ah in this._cellProperties){ae=Y(af,ab,"",ah)[0];if(!ae){continue}ag=this._cellProperties[ah];if(ag){ad[ah]=ag(x(ae))}else{if(ah==="Value"){ad[ah]=M(ae)}else{ad[ah]=x(ae)}}}ad.ordinal=this._getCellOrdinal(af);return ad},readCell:function(ad){if(!ad){ad={}}return this._readCell(this._cellNode,ad)},eachCell:function(ag,af,ad){var ae=[null];if(!af){af=this}if(ad){if(!K(ad)){ad=[ad]}ae=ae.concat(ad)}while(this.hasMoreCells()){this.nextCell();ae[0]=this.readCell();if(ag.apply(af,ae)===false){return false}}this._idx=0;return true},getByIndex:function(ae,ad){this._getCellNode(ae);return this.readCell(ad)},getByOrdinal:function(ae,ag){var ah,af,ad,ai=this.cellCount()-1;ad=ae>ai?ai:ae;while(true){ah=this._cellNodes[ad];af=this._getCellOrdinal(ah);if(af===ae){return this.getByIndex(ad,ag)}else{if(af>ae){ad--}else{return null}}}},indexForOrdinal:function(ad){var ae=ad,ag,af;while(true){af=this._cellNodes[ae];if(!af){af=this._cellNodes[this._cellNodes.length-1]}ag=this._getCellOrdinal(af);if(ag===ad){return ae}else{if(ag>ad){ae--}else{return -1}}}return null},fetchRangeAsArray:function(ah,ag){var ae=[],ad=this._cellNodes;ah=this.indexForOrdinal(ah);if(ah===-1){return ae}ag=this.indexForOrdinal(ag);if(ag===-1){ag=ad.length-1}ag=Math.min(ag,ad.length-1);for(var af=ah;af<=ag;af++){ae.push(this._readCell(ad[af],{}))}return ae},cellOrdinalForTupleIndexes:function(){throw"Not implemented"},getByTupleIndexes:function(){return this.getByOrdinal(this.cellOrdinalForTupleIndexes.apply(this,arguments))},close:function(){this._dataset=null;this._cellNodes=null;this._cellNode=null}};p.Exception=function(af,ah,ag,ad,aj,ai,ae){this.type=af;this.code=ah;this.message=ag;this.source=aj;this.helpfile=ad;this.data=ai;this.args=ae;return this};p.Exception.TYPE_WARNING="warning";p.Exception.TYPE_ERROR="error";var q="http://code.google.com/p/xmla4js/wiki/ExceptionCodes";p.Exception.MISSING_REQUEST_TYPE_CDE=-1;p.Exception.MISSING_REQUEST_TYPE_MSG="Missing_Request_Type";p.Exception.MISSING_REQUEST_TYPE_HLP=q+"#"+p.Exception.MISSING_REQUEST_TYPE_CDE+"_"+p.Exception.MISSING_REQUEST_TYPE_MSG;p.Exception.MISSING_STATEMENT_CDE=-2;p.Exception.MISSING_STATEMENT_MSG="Missing_Statement";p.Exception.MISSING_STATEMENT_HLP=q+"#"+p.Exception.MISSING_STATEMENT_CDE+"_"+p.Exception.MISSING_STATEMENT_MSG;p.Exception.MISSING_URL_CDE=-3;p.Exception.MISSING_URL_MSG="Missing_URL";p.Exception.MISSING_URL_HLP=q+"#"+p.Exception.MISSING_URL_CDE+"_"+p.Exception.MISSING_URL_MSG;p.Exception.NO_EVENTS_SPECIFIED_CDE=-4;p.Exception.NO_EVENTS_SPECIFIED_MSG="No_Events_Specified";p.Exception.NO_EVENTS_SPECIFIED_HLP=q+"#"+p.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+p.Exception.NO_EVENTS_SPECIFIED_MSG;p.Exception.WRONG_EVENTS_FORMAT_CDE=-5;p.Exception.WRONG_EVENTS_FORMAT_MSG="Wrong_Events_Format";p.Exception.WRONG_EVENTS_FORMAT_HLP=q+"#"+p.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+p.Exception.NO_EVENTS_SPECIFIED_MSG;p.Exception.UNKNOWN_EVENT_CDE=-6;p.Exception.UNKNOWN_EVENT_MSG="Unknown_Event";p.Exception.UNKNOWN_EVENT_HLP=q+"#"+p.Exception.UNKNOWN_EVENT_CDE+"_"+p.Exception.UNKNOWN_EVENT_MSG;p.Exception.INVALID_EVENT_HANDLER_CDE=-7;p.Exception.INVALID_EVENT_HANDLER_MSG="Invalid_Events_Handler";p.Exception.INVALID_EVENT_HANDLER_HLP=q+"#"+p.Exception.INVALID_EVENT_HANDLER_CDE+"_"+p.Exception.INVALID_EVENT_HANDLER_MSG;p.Exception.ERROR_PARSING_RESPONSE_CDE=-8;p.Exception.ERROR_PARSING_RESPONSE_MSG="Error_Parsing_Response";p.Exception.ERROR_PARSING_RESPONSE_HLP=q+"#"+p.Exception.ERROR_PARSING_RESPONSE_CDE+"_"+p.Exception.ERROR_PARSING_RESPONSE_MSG;p.Exception.INVALID_FIELD_CDE=-9;p.Exception.INVALID_FIELD_MSG="Invalid_Field";p.Exception.INVALID_FIELD_HLP=q+"#"+p.Exception.INVALID_FIELD_CDE+"_"+p.Exception.INVALID_FIELD_MSG;p.Exception.HTTP_ERROR_CDE=-10;p.Exception.HTTP_ERROR_MSG="HTTP Error";p.Exception.HTTP_ERROR_HLP=q+"#"+p.Exception.HTTP_ERROR_CDE+"_"+p.Exception.HTTP_ERROR_MSG;p.Exception.INVALID_HIERARCHY_CDE=-11;p.Exception.INVALID_HIERARCHY_MSG="Invalid_Hierarchy";p.Exception.INVALID_HIERARCHY_HLP=q+"#"+p.Exception.INVALID_HIERARCHY_CDE+"_"+p.Exception.INVALID_HIERARCHY_MSG;p.Exception.UNEXPECTED_ERROR_READING_MEMBER_CDE=-12;p.Exception.UNEXPECTED_ERROR_READING_MEMBER_MSG="Error_Reading_Member";p.Exception.UNEXPECTED_ERROR_READING_MEMBER_HLP=q+"#"+p.Exception.UNEXPECTED_ERROR_READING_MEMBER_CDE+"_"+p.Exception.UNEXPECTED_ERROR_READING_MEMBER_MSG;p.Exception.INVALID_AXIS_CDE=-13;p.Exception.INVALID_AXIS_MSG="The requested axis does not exist.";p.Exception.INVALID_AXIS_HLP=q+"#"+p.Exception.INVALID_AXIS_CDE+"_"+p.Exception.INVALID_AXIS_MSG;p.Exception.ILLEGAL_ARGUMENT_CDE=-14;p.Exception.ILLEGAL_ARGUMENT_MSG="Illegal arguments";p.Exception.ILLEGAL_ARGUMENT_HLP=q+"#"+p.Exception.ILLEGAL_ARGUMENT_CDE+"_"+p.Exception.ILLEGAL_ARGUMENT_MSG;p.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_CDE=-15;p.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_MSG="Error creating XML Http Request";p.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_HLP=q+"#"+p.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_CDE+"_"+p.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_MSG;p.Exception._newError=function(ad,af,ae){return new p.Exception(p.Exception.TYPE_ERROR,p.Exception[ad+"_CDE"],p.Exception[ad+"_MSG"],p.Exception[ad+"_HLP"],af,ae)};p.Exception.prototype={type:null,code:null,message:null,source:null,helpfile:null,data:null,_throw:function(){throw this},args:null,toString:function(){return this.type+" "+this.code+": "+this.message+" (source: "+this.source+")"},getStackTrace:function(){var ae,ad="";if(this.args){var af=this.args.callee;while(af){ae=String(af);af=af.caller}}return ad}};if(typeof(define)==="function"&&define.amd){define(function(){return p})}else{U.Xmla=p}return p})(typeof exports==="undefined"?window:exports);