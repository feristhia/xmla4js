(function(D){var n,F="http://schemas.xmlsoap.org/soap/",Y=F+"envelope/",V="SOAP-ENV",G="xmlns:"+V+'="'+Y+'"',m=V+':encodingStyle="'+F+'encoding/"',k="urn:schemas-microsoft-com:",j=k+"xml-analysis",I='xmlns="'+j+'"',l="sql",g=k+"xml-sql",t="http://www.w3.org/2001/XMLSchema",y="xsd",W="http://www.w3.org/2001/XMLSchema-instance",T="xsi",A=j+":rowset",X=j+":mddataset",x=window.ActiveXObject?true:false;function K(aa){var ad,Z=false,ab=function(){Z=true;switch(ad.readyState){case 0:aa.aborted(ad);break;case 4:if(ad.status===200){aa.complete(ad)}else{aa.error(n.Exception._newError("HTTP_ERROR","_ajax",{request:aa,status:this.status,statusText:this.statusText}))}break}};if(XMLHttpRequest){ad=new XMLHttpRequest()}else{if(x){ad=new ActiveXObject("MSXML2.XMLHTTP.3.0")}}if(aa.username&&aa.password){ad.open("POST",aa.url,aa.async,aa.username,aa.password)}else{ad.open("POST",aa.url,aa.async)}ad.onreadystatechange=ab;ad.setRequestHeader("Accept","text/xml, application/xml, application/soap+xml");ad.setRequestHeader("Content-Type","text/xml");if(aa.headers){var ac=aa.headers,ae;for(ae in ac){ad.setRequestHeader(ae,ac[ae])}}ad.send(aa.data);if(!aa.async&&!Z){ab.call(ad)}return ad}function O(Z){return typeof(Z)==="undefined"}function H(Z){return Z&&Z.constructor===Array}function i(Z){return typeof(Z)==="number"}function e(Z){return typeof(Z)==="function"}function S(Z){return typeof(Z)==="string"}function s(Z){return Z&&typeof(Z)==="object"}function p(Z){if(S(Z)){Z=Z.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}return Z}var f=document.documentElement;var U=f.getElementsByTagNameNS?function(ab,aa,ac,Z){return ab.getElementsByTagNameNS(aa,Z)}:function(ab,aa,ac,Z){if(ac){return ab.getElementsByTagName(ac+":"+Z)}else{return ab.getElementsByTagName(Z)}};var Q=f.getAttributeNS?function(aa,ab,ac,Z){return aa.getAttributeNS(ab,Z)}:function(aa,ab,ac,Z){if(ac){return aa.getAttribute(ac+":"+Z)}else{return aa.getAttribute(Z)}};function u(Z){var aa;if(!O(Z.innerText)){aa=function(ab){return ab.innerText}}else{if(!O(Z.textContent)){aa=function(ab){return ab.textContent}}else{if(!O(Z.nodeTypedValue)){aa=function(ab){return ab.nodeTypedValue}}else{if(Z.normalize){aa=function(ab){ab.normalize();if(ab.firstChild){return ab.firstChild.data}else{return null}}}else{aa=function(ad){var af=[],ac,ae=ad.childNodes,ab,ag=ae.length;for(ab=0;ab<ag;ab++){ac=ae.item(ab);if(ac.data!==null){af.push(ac.data)}}return af.length?af.join(""):null}}}}}u=aa;return aa(Z)}function E(Z,af,ae,ac){if(!ac){ac=""}var ab,ad,ag,ah,ai,aa="\n"+ac+"<"+Z+">";if(ae){aa+="\n"+ac+" <"+af+">";for(ah in ae){if(ae.hasOwnProperty(ah)){ai=ae[ah];aa+="\n"+ac+"  <"+ah+">";if(H(ai)){ab=ai.length;for(ad=0;ad<ab;ad++){ag=ai[ad];aa+="<Value>"+p(ag)+"</Value>"}}else{aa+=p(ai)}aa+="</"+ah+">"}}aa+="\n"+ac+" </"+af+">"}aa+="\n"+ac+"</"+Z+">";return aa}var b="RequestType";function R(Z){var ab=Z.method,aa='<?xml version="1.0" encoding="UTF-8"?>\n<'+V+":Envelope "+G+" "+m+">\n <"+V+":Body>\n  <"+ab+" "+I+" "+m+">";switch(ab){case n.METHOD_DISCOVER:if(!Z.requestType){n.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",Z)._throw()}aa+="\n   <"+b+">"+Z.requestType+"</"+b+">"+E("Restrictions","RestrictionList",Z.restrictions,"   ")+E("Properties","PropertyList",Z.properties,"   ");break;case n.METHOD_EXECUTE:if(!Z.statement){n.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",Z)._throw()}aa+="\n   <Command>\n    <Statement>"+p(Z.statement)+"</Statement>\n   </Command>"+E("Properties","PropertyList",Z.properties,"   ");break;default:}aa+="\n  </"+ab+">\n </"+V+":Body>\n</"+V+":Envelope>";return aa}function h(aa,ab,Z){if(ab&&(!aa)){aa={}}var ac;for(ac in ab){if(ab.hasOwnProperty(ac)){if(Z||O(aa[ac])){aa[ac]=ab[ac]}}}return aa}n=D.Xmla=function(Z){this.listeners={};this.listeners[n.EVENT_REQUEST]=[];this.listeners[n.EVENT_SUCCESS]=[];this.listeners[n.EVENT_ERROR]=[];this.listeners[n.EVENT_DISCOVER]=[];this.listeners[n.EVENT_DISCOVER_SUCCESS]=[];this.listeners[n.EVENT_DISCOVER_ERROR]=[];this.listeners[n.EVENT_EXECUTE]=[];this.listeners[n.EVENT_EXECUTE_SUCCESS]=[];this.listeners[n.EVENT_EXECUTE_ERROR]=[];this.options=h(h({},n.defaultOptions,true),Z,true);var aa=this.options.listeners;if(aa){this.addListener(aa)}return this};n.defaultOptions={requestTimeout:30000,async:false,addFieldGetters:true};n.METHOD_DISCOVER="Discover";n.METHOD_EXECUTE="Execute";var N="DISCOVER_";var c="MDSCHEMA_";var v="DBSCHEMA_";n.DISCOVER_DATASOURCES=N+"DATASOURCES";n.DISCOVER_PROPERTIES=N+"PROPERTIES";n.DISCOVER_SCHEMA_ROWSETS=N+"SCHEMA_ROWSETS";n.DISCOVER_ENUMERATORS=N+"ENUMERATORS";n.DISCOVER_KEYWORDS=N+"KEYWORDS";n.DISCOVER_LITERALS=N+"LITERALS";n.DBSCHEMA_CATALOGS=v+"CATALOGS";n.DBSCHEMA_COLUMNS=v+"COLUMNS";n.DBSCHEMA_PROVIDER_TYPES=v+"PROVIDER_TYPES";n.DBSCHEMA_SCHEMATA=v+"SCHEMATA";n.DBSCHEMA_TABLES=v+"TABLES";n.DBSCHEMA_TABLES_INFO=v+"TABLES_INFO";n.MDSCHEMA_ACTIONS=c+"ACTIONS";n.MDSCHEMA_CUBES=c+"CUBES";n.MDSCHEMA_DIMENSIONS=c+"DIMENSIONS";n.MDSCHEMA_FUNCTIONS=c+"FUNCTIONS";n.MDSCHEMA_HIERARCHIES=c+"HIERARCHIES";n.MDSCHEMA_LEVELS=c+"LEVELS";n.MDSCHEMA_MEASURES=c+"MEASURES";n.MDSCHEMA_MEMBERS=c+"MEMBERS";n.MDSCHEMA_PROPERTIES=c+"PROPERTIES";n.MDSCHEMA_SETS=c+"SETS";n.EVENT_REQUEST="request";n.EVENT_SUCCESS="success";n.EVENT_ERROR="error";n.EVENT_EXECUTE="execute";n.EVENT_EXECUTE_SUCCESS="executesuccess";n.EVENT_EXECUTE_ERROR="executeerror";n.EVENT_DISCOVER="discover";n.EVENT_DISCOVER_SUCCESS="discoversuccess";n.EVENT_DISCOVER_ERROR="discovererror";n.EVENT_GENERAL=[n.EVENT_REQUEST,n.EVENT_SUCCESS,n.EVENT_ERROR];n.EVENT_DISCOVER_ALL=[n.EVENT_DISCOVER,n.EVENT_DISCOVER_SUCCESS,n.EVENT_DISCOVER_ERROR];n.EVENT_EXECUTE_ALL=[n.EVENT_EXECUTE,n.EVENT_EXECUTE_SUCCESS,n.EVENT_EXECUTE_ERROR];n.EVENT_ALL=[].concat(n.EVENT_GENERAL,n.EVENT_DISCOVER_ALL,n.EVENT_EXECUTE_ALL);n.PROP_DATASOURCEINFO="DataSourceInfo";n.PROP_CATALOG="Catalog";n.PROP_CUBE="Cube";n.PROP_FORMAT="Format";n.PROP_FORMAT_TABULAR="Tabular";n.PROP_FORMAT_MULTIDIMENSIONAL="Multidimensional";n.PROP_AXISFORMAT="AxisFormat";n.PROP_AXISFORMAT_TUPLE="TupleFormat";n.PROP_AXISFORMAT_CLUSTER="ClusterFormat";n.PROP_AXISFORMAT_CUSTOM="CustomFormat";n.PROP_CONTENT="Content";n.PROP_CONTENT_DATA="Data";n.PROP_CONTENT_NONE="None";n.PROP_CONTENT_SCHEMA="Schema";n.PROP_CONTENT_SCHEMADATA="SchemaData";n.prototype={listeners:null,soapMessage:null,response:null,responseText:null,responseXML:null,setOptions:function(Z){h(this.options,Z,true)},addListener:function(){var aa=arguments.length;switch(aa){case 0:n.Exception._newError("NO_EVENTS_SPECIFIED","Xmla.addListener",null)._throw();case 1:var ah=arguments[0];if(s(ah)){var ag,ab;if(H(ah)){this._addListeners(ah)}else{if(ag=ah.events||ah.event){if(S(ag)){ag=(ag==="all")?n.EVENT_ALL:ag.split(",")}if(!(H(ag))){n.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",ah)._throw()}var ac,aa=ag.length;for(ac=0;ac<aa;ac++){this._addListener(ag[ac],ah)}}else{var ae=ah.scope,af;if(O(ae)){ae=null}else{delete ah.scope}for(ag in ah){af=ah[ag];if(O(af.scope)){af.scope=ae}this._addListener(ag,af)}}}}else{n.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",ah)._throw()}break;case 2:case 3:var Z=arguments[0],af=arguments[1],ae=arguments[2];if(S(Z)&&(e(af)||(s(af)))){this._addListener(Z,af,ae)}else{var ad=[Z,af];if(ae){ad.push(ae)}this.addListener(ad)}break;default:this._addListeners(arguments)}},_addListeners:function(aa){var Z,ab=aa.length;for(Z=0;Z<ab;Z++){this.addListener(aa[Z])}},_addListener:function(aa,ae,ad){var ac=this.listeners[aa];if(!ac){n.Exception._newError("UNKNOWN_EVENT","Xmla.addListener",{event:aa,handler:ae,scope:ad})._throw()}if(!ad){ad=null}switch(typeof(ae)){case"function":ac.concat({handler:ae,scope:ad});break;case"object":var Z=ae.handler||ae.handlers;if(e(Z.handler)){if(!Z.scope){Z.scope=ad}ac.concat(ae)}else{if(H(Z)){var ab,af=Z.length;for(ab=0;ab<af;ab++){this._addListener(aa,Z[ab])}}}break}},_fireEvent:function(ae,ah,aa){var af=this.listeners[ae];if(!af){n.Exception._newError("UNKNOWN_EVENT","Xmla._fireEvent",ae)._throw()}var ab=af.length,Z=true;if(ab){var ac,ag,ad;for(ad=0;ad<ab;ad++){ac=af[ad];ag=ac.handler.call(ac.scope,ae,ah,this);if(aa&&ag===false){Z=false;break}}}else{if(ae===n.EVENT_ERROR&&!e(ah.error)&&!e(ah.callback)){ah.exception._throw()}}return Z},request:function(aa){var ac,ab=this;this.response=null;this.responseText=null;this.responseXML=null;if(!aa.url){if(this.options.url){aa.url=this.options.url}else{ac=n.Exception._newError("MISSING_URL","Xmla.request",aa);ac._throw()}}aa.properties=h(aa.properties,this.options.properties,false);aa.restrictions=h(aa.restrictions,this.options.restrictions,false);if(O(aa.async)&&!O(this.options.async)){aa.async=this.options.async}if(O(aa.requestTimeout)&&!O(this.options.requestTimeout)){aa.requestTimeout=this.options.requestTimeout}if(!aa.username&&this.options.username){aa.username=this.options.username}if(!aa.password&&this.options.password){aa.password=this.options.password}if(!aa.headers&&this.options.headers){aa.headers=this.options.headers}var ad=R(aa);this.soapMessage=ad;var ae;var Z={async:aa.async,timeout:aa.requestTimeout,data:ad,error:function(af){aa.exception=af;ab._requestError(aa)},complete:function(af){aa.xhr=af;ab._requestSuccess(aa)},url:aa.url};if(aa.username){Z.username=aa.username}if(aa.password){Z.password=aa.password}if(aa.headers){Z.headers=aa.headers}if(this._fireEvent(n.EVENT_REQUEST,aa,true)&&((aa.method==n.METHOD_DISCOVER&&this._fireEvent(n.EVENT_DISCOVER,aa))||(aa.method==n.METHOD_EXECUTE&&this._fireEvent(n.EVENT_EXECUTE,aa)))){ae=K(Z)}return this.response},_requestError:function(Z){if(Z.error){Z.error.call(Z.scope?Z.scope:null,this,Z,null)}if(Z.callback){Z.callback.call(Z.scope?Z.scope:null,n.EVENT_ERROR,this,Z,null)}this._fireEvent(n.EVENT_ERROR,Z)},_requestSuccess:function(ab){var af=ab.xhr,aa;this.responseXML=af.responseXML;this.responseText=af.responseText;var ag=ab.method;var Z=U(this.responseXML,Y,V,"Fault");if(Z.length){Z=Z.item(0);ab.exception=new n.Exception(n.Exception.TYPE_ERROR,Z.getElementsByTagName("faultcode").item(0).childNodes.item(0).data,Z.getElementsByTagName("faultstring").item(0).childNodes.item(0).data,null,"_requestSuccess",ab);switch(ag){case n.METHOD_DISCOVER:this._fireEvent(n.EVENT_DISCOVER_ERROR,ab);break;case n.METHOD_EXECUTE:this._fireEvent(n.EVENT_EXECUTE_ERROR,ab);break}if(ab.error){ab.error.call(ab.scope?ab.scope:null,this,ab,ab.exception)}if(ab.callback){ab.callback.call(ab.scope?ab.scope:null,n.EVENT_ERROR,this,ab,ab.exception)}this._fireEvent(n.EVENT_ERROR,ab)}else{switch(ag){case n.METHOD_DISCOVER:ab.rowset=this.response=aa=new n.Rowset(this.responseXML,ab.requestType,this);this._fireEvent(n.EVENT_DISCOVER_SUCCESS,ab);break;case n.METHOD_EXECUTE:var ae=null,ad=null;var ac=ab.properties[n.PROP_FORMAT];switch(ac){case n.PROP_FORMAT_TABULAR:aa=ae=new n.Rowset(this.responseXML,null,this);break;case n.PROP_FORMAT_MULTIDIMENSIONAL:aa=ad=new n.Dataset(this.responseXML);break}ab.resultset=ae;ab.dataset=ad;this.response=aa;this._fireEvent(n.EVENT_EXECUTE_SUCCESS,ab);break}if(ab.success){ab.success.call(ab.scope?ab.scope:null,this,ab,aa)}if(ab.callback){ab.callback.call(ab.scope?ab.scope:null,n.EVENT_SUCCESS,this,ab,aa)}this._fireEvent(n.EVENT_SUCCESS,ab)}},execute:function(Z){var aa=Z.properties;if(!aa){aa={};Z.properties=aa}h(aa,this.options.properties,false);if(!aa[n.PROP_CONTENT]){aa[n.PROP_CONTENT]=n.PROP_CONTENT_SCHEMADATA}if(!aa[n.PROP_FORMAT]){Z.properties[n.PROP_FORMAT]=n.PROP_FORMAT_MULTIDIMENSIONAL}var ab=h(Z,{method:n.METHOD_EXECUTE},true);return this.request(ab)},executeTabular:function(Z){if(!Z.properties){Z.properties={}}Z.properties[n.PROP_FORMAT]=n.PROP_FORMAT_TABULAR;return this.execute(Z)},executeMultiDimensional:function(Z){if(!Z.properties){Z.properties={}}Z.properties[n.PROP_FORMAT]=n.PROP_FORMAT_MULTIDIMENSIONAL;return this.execute(Z)},discover:function(Z){var aa=h(Z,{method:n.METHOD_DISCOVER},true);if(!aa.requestType){aa.requestType=this.options.requestType}return this.request(aa)},discoverDataSources:function(Z){var aa=h(Z,{requestType:n.DISCOVER_DATASOURCES},true);return this.discover(aa)},discoverProperties:function(Z){var aa=h(Z,{requestType:n.DISCOVER_PROPERTIES},true);return this.discover(aa)},discoverSchemaRowsets:function(Z){var aa=h(Z,{requestType:n.DISCOVER_SCHEMA_ROWSETS},true);return this.discover(aa)},discoverEnumerators:function(Z){var aa=h(Z,{requestType:n.DISCOVER_ENUMERATORS},true);return this.discover(aa)},discoverKeywords:function(Z){var aa=h(Z,{requestType:n.DISCOVER_KEYWORDS},true);return this.discover(aa)},discoverLiterals:function(Z){var aa=h(Z,{requestType:n.DISCOVER_LITERALS},true);return this.discover(aa)},discoverDBCatalogs:function(Z){var aa=h(Z,{requestType:n.DBSCHEMA_CATALOGS},true);return this.discover(aa)},discoverDBColumns:function(Z){var aa=h(Z,{requestType:n.DBSCHEMA_COLUMNS},true);return this.discover(aa)},discoverDBProviderTypes:function(Z){var aa=h(Z,{requestType:n.DBSCHEMA_PROVIDER_TYPES},true);return this.discover(aa)},discoverDBSchemata:function(Z){var aa=h(Z,{requestType:n.DBSCHEMA_SCHEMATA},true);return this.discover(aa)},discoverDBTables:function(Z){var aa=h(Z,{requestType:n.DBSCHEMA_TABLES},true);return this.discover(aa)},discoverDBTablesInfo:function(Z){var aa=h(Z,{requestType:n.DBSCHEMA_TABLES_INFO},true);return this.discover(aa)},discoverMDActions:function(Z){var aa=h(Z,{requestType:n.MDSCHEMA_ACTIONS},true);return this.discover(aa)},discoverMDCubes:function(Z){var aa=h(Z,{requestType:n.MDSCHEMA_CUBES},true);return this.discover(aa)},discoverMDDimensions:function(Z){var aa=h(Z,{requestType:n.MDSCHEMA_DIMENSIONS},true);return this.discover(aa)},discoverMDFunctions:function(Z){var aa=h(Z,{requestType:n.MDSCHEMA_FUNCTIONS},true);return this.discover(aa)},discoverMDHierarchies:function(Z){var aa=h(Z,{requestType:n.MDSCHEMA_HIERARCHIES},true);return this.discover(aa)},discoverMDLevels:function(Z){var aa=h(Z,{requestType:n.MDSCHEMA_LEVELS},true);return this.discover(aa)},discoverMDMeasures:function(Z){var aa=h(Z,{requestType:n.MDSCHEMA_MEASURES},true);return this.discover(aa)},discoverMDMembers:function(Z){var aa=h(Z,{requestType:n.MDSCHEMA_MEMBERS},true);return this.discover(aa)},discoverMDProperties:function(Z){var aa=h(Z,{requestType:n.MDSCHEMA_PROPERTIES},true);return this.discover(aa)},discoverMDSets:function(Z){var aa=h(Z,{requestType:n.MDSCHEMA_SETS},true);return this.discover(aa)}};function B(ae,Z){var ab=U(ae,t,y,"complexType"),ad=ab.length,ac,aa;for(aa=0;aa<ad;aa++){ac=ab.item(aa);if(ac.getAttribute("name")===Z){return ac}}return null}n.Rowset=function(ab,Z,aa){this._node=ab;this._type=Z;this._xmla=aa;this._initData();return this};n.Rowset.MD_DIMTYPE_UNKNOWN=0;n.Rowset.MD_DIMTYPE_TIME=1;n.Rowset.MD_DIMTYPE_MEASURE=2;n.Rowset.MD_DIMTYPE_OTHER=3;n.Rowset.MD_DIMTYPE_QUANTITATIVE=5;n.Rowset.MD_DIMTYPE_ACCOUNTS=6;n.Rowset.MD_DIMTYPE_CUSTOMERS=7;n.Rowset.MD_DIMTYPE_PRODUCTS=8;n.Rowset.MD_DIMTYPE_SCENARIO=9;n.Rowset.MD_DIMTYPE_UTILIY=10;n.Rowset.MD_DIMTYPE_CURRENCY=11;n.Rowset.MD_DIMTYPE_RATES=12;n.Rowset.MD_DIMTYPE_CHANNEL=13;n.Rowset.MD_DIMTYPE_PROMOTION=14;n.Rowset.MD_DIMTYPE_ORGANIZATION=15;n.Rowset.MD_DIMTYPE_BILL_OF_MATERIALS=16;n.Rowset.MD_DIMTYPE_GEOGRAPHY=17;n.Rowset.MD_STRUCTURE_FULLYBALANCED=0;n.Rowset.MD_STRUCTURE_RAGGEDBALANCED=1;n.Rowset.MD_STRUCTURE_UNBALANCED=2;n.Rowset.MD_STRUCTURE_NETWORK=3;n.Rowset.MD_USER_DEFINED=1;n.Rowset.MD_SYSTEM_ENABLED=2;n.Rowset.MD_SYSTEM_INTERNAL=4;n.Rowset.MDMEMBER_TYPE_REGULAR=1;n.Rowset.MDMEMBER_TYPE_ALL=2;n.Rowset.MDMEMBER_TYPE_FORMULA=3;n.Rowset.MDMEMBER_TYPE_MEASURE=4;n.Rowset.MDMEMBER_TYPE_UNKNOWN=0;n.Rowset.KEYS={};n.Rowset.KEYS[n.DBSCHEMA_CATALOGS]=["CATALOG_NAME"];n.Rowset.KEYS[n.DBSCHEMA_COLUMNS]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME","COLUMN_NAME"];n.Rowset.KEYS[n.DBSCHEMA_PROVIDER_TYPES]=["TYPE_NAME"];n.Rowset.KEYS[n.DBSCHEMA_SCHEMATA]=["CATALOG_NAME","SCHEMA_NAME"];n.Rowset.KEYS[n.DBSCHEMA_TABLES]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME"];n.Rowset.KEYS[n.DBSCHEMA_TABLES_INFO]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME"];n.Rowset.KEYS[n.DISCOVER_DATASOURCES]=["DataSourceName"];n.Rowset.KEYS[n.DISCOVER_ENUMERATORS]=["EnumName","ElementName"];n.Rowset.KEYS[n.DISCOVER_KEYWORDS]=["Keyword"];n.Rowset.KEYS[n.DISCOVER_LITERALS]=["LiteralName"];n.Rowset.KEYS[n.DISCOVER_PROPERTIES]=["PropertyName"];n.Rowset.KEYS[n.DISCOVER_SCHEMA_ROWSETS]=["SchemaName"];n.Rowset.KEYS[n.MDSCHEMA_ACTIONS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","ACTION_NAME"];n.Rowset.KEYS[n.MDSCHEMA_CUBES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME"];n.Rowset.KEYS[n.MDSCHEMA_DIMENSIONS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME"];n.Rowset.KEYS[n.MDSCHEMA_FUNCTIONS]=["FUNCTION_NAME","PARAMETER_LIST"];n.Rowset.KEYS[n.MDSCHEMA_HIERARCHIES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME"];n.Rowset.KEYS[n.MDSCHEMA_LEVELS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME"];n.Rowset.KEYS[n.MDSCHEMA_MEASURES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","MEASURE_NAME"];n.Rowset.KEYS[n.MDSCHEMA_MEMBERS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME","MEMBER_UNIQUE_NAME"];n.Rowset.KEYS[n.MDSCHEMA_PROPERTIES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME","MEMBER_UNIQUE_NAME","PROPERTY_NAME"];n.Rowset.KEYS[n.MDSCHEMA_SETS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","SET_NAME"];function M(Z){return Z==="true"?true:false}M.jsType="boolean";function r(Z){return parseInt(Z,10)}r.jsType="number";function z(Z){return parseFloat(Z,10)}z.jsType="number";function C(Z){return Z}C.jsType="string";function q(Z){return Date.parse(Z)}q.jsType="object";function d(Z){return Z}d.jsType="object";function L(ab,aa){var Z=[],ae=ab.length,ac,ad;for(ac=0;ac<ae;ac++){ad=ab.item(ac);Z.push(aa(u(ad)))}return Z}L.jsType="object";var a={"xsd:boolean":M,"xsd:decimal":z,"xsd:double":z,"xsd:float":z,"xsd:int":r,"xsd:integer":r,"xsd:nonPositiveInteger":r,"xsd:negativeInteger":r,"xsd:nonNegativeInteger":r,"xsd:positiveInteger":r,"xsd:short":r,"xsd:byte":r,"xsd:long":r,"xsd:unsignedLong":r,"xsd:unsignedInt":r,"xsd:unsignedShort":r,"xsd:unsignedByte":r,"xsd:string":C,"xsd:dateTime":q,Restrictions:d};function P(aa){var ab=a[aa],Z;if(!ab){ab=C}return ab}function J(ac){var Z=u(ac),ab=Q(ac,W,T,"type"),aa;if(ab){aa=a[ab];if(aa){return aa(Z)}}return Z}function w(Z){return"get"+(/^[A-Z]+[a-z]+[A-Za-z]*$/g.test(Z)?Z:Z.charAt(0).toUpperCase()+Z.substr(1).toLowerCase().replace(/_[a-z]/g,function(aa){return aa.charAt(1).toUpperCase()}))}n.Rowset.prototype={_node:null,_type:null,_row:null,_rows:null,numRows:null,fieldOrder:null,fields:null,_fieldCount:null,_initData:function(){this._rows=U(this._node,A,null,"row");this.numRows=this._rows?this._rows.length:0;this.reset();this.fieldOrder=[];this.fields={};this._fieldCount=0;var ah=B(this._node,"row");if(ah){var an=U(ah,t,y,"sequence").item(0),ae=an.childNodes,ag=ae.length,al,aa,am,ai,ad,ak,ab,aj,Z=this._xmla.options.addFieldGetters,af,ac;for(af=0;af<ag;af++){al=ae.item(af);if(al.nodeType!==1){continue}aa=Q(al,g,l,"field");am=al.getAttribute("name");ak=al.getAttribute("type");if(ak===null&&this._row){ac=this._row.getElementsByTagName(am);if(ac.length){ak=Q(ac.item(0),W,T,"type")}}if(!ak&&this._type==n.DISCOVER_SCHEMA_ROWSETS&&am==="Restrictions"){ak="Restrictions"}ai=al.getAttribute("minOccurs");if(ai){ai=parseInt(ai,10)}else{ai=1}ad=al.getAttribute("maxOccurs");if(ad){if(ad==="unbounded"){ad=Infinity}else{ai=parseInt(ad,10)}}else{ad=1}ab=P(ak);aj=this._createFieldGetter(am,ab,ai,ad);if(Z){this[w(am)]=aj}this.fields[aa]={name:am,label:aa,index:this._fieldCount++,type:ak,jsType:ab.jsType,minOccurs:ai,maxOccurs:ad,getter:aj};this.fieldOrder.push(aa)}}else{n.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",this._node)._throw()}},_createFieldGetter:function(ae,aa,ad,ab){var ac=this;var Z;if(ab===1){if(ad===1){Z=function(){var af=U(this._row,A,null,ae);return aa(u(af.item(0)))}}else{if(ad===0){Z=function(){var af=U(this._row,A,null,ae);if(af.length){return aa(u(af.item(0)))}else{return null}}}}}else{if(ad===1){Z=function(){var af=U(this._row,A,null,ae);return L(af,aa)}}else{if(ad===0){Z=function(){var af=U(this._row,A,null,ae);if(af.length){return L(af,aa)}else{return null}}}}}return Z},getType:function(){return this._type},getFields:function(){var ab=[],aa,ac=this._fieldCount,Z=this.fieldOrder;for(aa=0;aa<ac;aa++){ab[aa]=this.fieldDef(Z[aa])}return ab},getFieldNames:function(){var aa=[],Z,ab=this._fieldCount;for(Z=0;Z<ab;Z++){aa[Z]=this.fieldOrder[Z]}return aa},hasMoreRows:function(){return this.numRows>this.rowIndex},nextRow:function(){this.rowIndex++;this._row=this._rows.item(this.rowIndex);return this.rowIndex},next:function(){return this.nextRow()},eachRow:function(ac,ab,Z){if(O(ab)){ab=this}var aa=[null];if(!O(Z)){if(!H(Z)){Z=[Z]}aa=aa.concat(Z)}while(this.hasMoreRows()){aa[0]=this.readAsObject();if(ac.apply(ab,aa)===false){return false}this.nextRow()}return true},currRow:function(){return this.rowIndex},rowCount:function(){return this.numRows},reset:function(){this.rowIndex=0;this._row=(this.hasMoreRows())?this._rows.item(this.rowIndex):null},fieldDef:function(Z){var aa=this.fields[Z];if(!aa){n.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",Z)._throw()}return aa},fieldIndex:function(Z){return this.fieldDef(Z).index},fieldName:function(Z){var aa=this.fieldOrder[Z];if(!aa){n.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",Z)._throw()}return aa},fieldVal:function(Z){if(i(Z)){Z=this.fieldName(Z)}return this.fieldDef(Z).getter.call(this)},fieldCount:function(){return this._fieldCount},close:function(){this._node=null;this._row=null;this._rows=null},readAsArray:function(ac){var Z=this.fields,ab,aa;if(!ac){ac=[]}for(ab in Z){if(Z.hasOwnProperty(ab)){aa=Z[ab];ac[aa.index]=aa.getter.call(this)}}return ac},fetchAsArray:function(Z){if(this.hasMoreRows()){Z=this.readAsArray(Z);this.nextRow()}else{Z=false}return Z},readAsObject:function(aa){var Z=this.fields,ac,ab;if(!aa){aa={}}for(ac in Z){if(Z.hasOwnProperty(ac)){ab=Z[ac];aa[ac]=ab.getter.call(this)}}return aa},fetchAsObject:function(Z){if(this.hasMoreRows()){Z=this.readAsObject(Z);this.nextRow()}else{Z=false}return Z},fetchCustom:function(ab,aa){var Z;if(this.hasMoreRows()){Z=ab.call(this,aa);this.nextRow()}else{Z=false}return Z},fetchAllAsArray:function(Z){var aa;if(!Z){Z=[]}while((aa=this.fetchAsArray())){Z.push(aa)}return Z},fetchAllAsObject:function(Z){var aa;if(!Z){Z=[]}while((aa=this.fetchAsObject())){Z.push(aa)}return Z},fetchAllCustom:function(ab,aa,Z){var ac;if(!ab){ab=[]}while((ac=this.fetchCustom(aa,Z))){ab.push(ac)}return ab},mapAsObject:function(Z,ag,ai){var ac,ah,aa,ad,ae=ag.length,af=ae-1,ab=Z;for(ad=0;ad<ae;ad++){ac=ag[ad];ah=ai[ac];aa=ab[ah];if(aa){if(ad===af){if(H(aa)){aa.push(ai)}else{ab[ah]=[aa,ai]}}else{ab=aa}}else{if(ad===af){ab[ah]=ai}else{ab=ab[ah]={}}}}},mapAllAsObject:function(Z,aa){if(!aa){aa={}}if(!Z){Z=this.getKey()}var ab;while(ab=this.fetchAsObject()){this.mapAsObject(aa,Z,ab)}return aa},getKey:function(){return(this._type)?n.Rowset.KEYS[this._type]:this.getFieldNames()}};n.Dataset=function(Z){this._initDataset(Z);return this};n.Dataset.AXIS_COLUMNS=0;n.Dataset.AXIS_ROWS=1;n.Dataset.AXIS_PAGES=2;n.Dataset.AXIS_SECTIONS=3;n.Dataset.AXIS_CHAPTERS=4;n.Dataset.AXIS_SLICER="SlicerAxis";n.Dataset.prototype={_root:null,_axes:null,_axesOrder:null,_numAxes:null,_slicer:null,_cellset:null,_initDataset:function(ag){this._initRoot(ag);this.cubeName=u(U(this._root,X,"","CubeName").item(0));this._initAxes();this._initCells();var Z,ab,aa,ad,ae,ac="",af;ae="var ordinal = 0, a;\nif (arguments.length !== "+this._numAxes+') new Xmla.Exception._newError("ERROR_ILLEGAL_ARGUMENT", "cellOrdinalForTupleIndexes", this)._throw();';for(Z=0,ab=this._numAxes-1;ab>=0;ab--,Z++){ae+="\nif (typeof(a = arguments["+Z+'])!=="number") new Xmla.Exception._newError("ERROR_ILLEGAL_ARGUMENT", "cellOrdinalForTupleIndexes", this)._throw();';af=1;for(aa=ab-1;aa>=0;aa--){af*=this._axesOrder[aa].tupleCount()}ae+="\nordinal += a ";if(ab){ae+="* "+af+";"}}ae+=ac+"\nreturn ordinal;";this._cellset.cellOrdinalForTupleIndexes=this.cellOrdinalForTupleIndexes=new Function(ae)},_initRoot:function(aa){var Z=U(aa,X,"","root");if(Z.length){this._root=Z.item(0)}else{n.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Dataset._initData",aa)._throw()}},_initAxes:function(){var ac,ad,aa,af,ab,Z,ae={};this._axes={};this._axesOrder=[];ab=U(this._root,X,"","AxisInfo");Z=ab.length;for(ac=0;ac<Z;ac++){aa=ab.item(ac);af=aa.getAttribute("name");ae[af]=aa}ab=U(this._root,X,"","Axis");Z=ab.length;for(ac=0;ac<Z;ac++){aa=ab.item(ac);af=aa.getAttribute("name");ad=new n.Dataset.Axis(ae[af],aa,af,ac);if(af===n.Dataset.AXIS_SLICER){this._slicer=ad}else{this._axes[af]=ad;this._axesOrder.push(ad)}}this._numAxes=this._axesOrder.length},_initCells:function(){this._cellset=new n.Dataset.Cellset(this)},axisCount:function(){return this._numAxes},_getAxis:function(Z){var aa,ab;switch(typeof(Z)){case"number":ab=this._axesOrder[Z];break;case"string":ab=(aa===n.Dataset.AXIS_SLICER)?this._slicer:this._axes[aa];break}return ab},getAxis:function(Z){if(Z===n.Dataset.AXIS_SLICER){return this._slicer}var aa=this._getAxis(Z);if(!aa){n.Exception._newError("INVALID_AXIS","Xmla.Dataset.getAxis",Z)._throw()}return aa},hasAxis:function(Z){var aa=this._getAxis(Z);return !O(aa)},getColumnAxis:function(){return this.getAxis(n.Dataset.AXIS_COLUMNS)},hasColumnAxis:function(){return this.hasAxis(n.Dataset.AXIS_COLUMNS)},getRowAxis:function(){return this.getAxis(n.Dataset.AXIS_ROWS)},hasRowAxis:function(){return this.hasAxis(n.Dataset.AXIS_ROWS)},getPageAxis:function(){return this.getAxis(n.Dataset.AXIS_PAGES)},hasPageAxis:function(){return this.hasAxis(n.Dataset.AXIS_PAGES)},getSectionAxis:function(){return this.getAxis(n.Dataset.AXIS_SECTIONS)},hasSectionAxis:function(){return this.hasAxis(n.Dataset.AXIS_SECTIONS)},getChapterAxis:function(){return this.getAxis(n.Dataset.AXIS_CHAPTERS)},hasChapterAxis:function(){return this.hasAxis(n.Dataset.AXIS_CHAPTERS)},getSlicerAxis:function(){return this._slicer},getCellset:function(){return this._cellset},cellOrdinalForTupleIndexes:function(){throw"Not implemented"},close:function(){if(this._slicer){this._slicer.close()}var Z,aa=this._numAxes;for(Z=0;Z<aa;Z++){this.getAxis(Z).close()}this._cellset.close();this._root=null;this._axes=null;this._axesOrder=null;this._numAxes=null;this._slicer=null}};n.Dataset.Axis=function(ac,Z,aa,ab){this._initAxis(ac,Z);this.name=aa;this.id=ab;return this};n.Dataset.Axis.MEMBER_UNIQUE_NAME="UName";n.Dataset.Axis.MEMBER_CAPTION="Caption";n.Dataset.Axis.MEMBER_LEVEL_NAME="LName";n.Dataset.Axis.MEMBER_LEVEL_NUMBER="LNum";n.Dataset.Axis.MEMBER_DISPLAY_INFO="DisplayInfo";n.Dataset.Axis.prototype={_tuples:null,_members:null,numTuples:null,numHierarchies:null,_tupleIndex:null,_hierarchyIndex:null,_hierarchyOrder:null,_hierarchyDefs:null,_hierarchyIndexes:null,_initHierarchies:function(Z){var ah=U(Z,X,"","HierarchyInfo"),ae=ah.length,ac,aa,aj,ad,ag,ab,af,ai;this._hierarchyDefs={};this._hierarchyOrder=[];this._hierarchyIndexes={};this.numHierarchies=ae;for(ac=0;ac<ae;ac++){aj=ah.item(ac);ad=aj.getAttribute("name");this._hierarchyOrder[ac]=ad;this._hierarchyIndexes[ad]=ac;ag={index:ac,name:ad};af=U(Z,X,"","*");ab=af.length;for(aa=0;aa<ab;aa++){ai=af.item(aa);ag[ai.tagName]=null}this._hierarchyDefs[ad]=ag}},_initAxis:function(aa,Z){this.name=Z.getAttribute("name");this._initHierarchies(aa);this._tuples=U(Z,X,"","Tuple");this.numTuples=this._tuples.length;this.reset()},_getMembers:function(){if(!this.hasMoreTuples()){return null}return U(this._tuples.item(this._tupleIndex),X,"","Member")},reset:function(){this._hierarchyIndex=0;this._tupleIndex=0;this._members=this._getMembers()},hasMoreHierarchies:function(){return this.numHierarchies>this._hierarchyIndex},nextHierarchy:function(){return this._hierarchyIndex++},eachHierarchy:function(ac,ab,Z){var aa=[null];if(!ab){ab=this}if(Z){if(!H(Z)){Z=[Z]}aa=aa.concat(Z)}while(this.hasMoreHierarchies()){aa[0]=this._hierarchyDefs[this._hierarchyOrder[this._hierarchyIndex]];if(ac.apply(ab,aa)===false){return false}this.nextHierarchy()}this._hierarchyIndex=0;return true},hasMoreTuples:function(){return this.numTuples>this._tupleIndex},nextTuple:function(){this._tupleIndex++;this._members=this._getMembers();return this._tupleIndex},tupleCount:function(){return this.numTuples},tupleIndex:function(){return this._tupleIndex},getTuple:function(){var ac,ad=this.numHierarchies,aa={},ab=[],Z={index:this._tupleIndex,hierarchies:aa,members:ab};for(ac=0;ac<ad;ac++){ab.push(aa[this._hierarchyOrder[ac]]=this._member(ac))}return Z},eachTuple:function(ac,ab,Z){var aa=[null];if(!ab){ab=this}if(Z){if(H(Z)){aa.concat(Z)}else{aa.push(Z)}}while(this.hasMoreTuples()){aa[0]=this.getTuple();if(ac.apply(ab,aa)===false){return false}this.nextTuple()}this._tupleIndex=0;this._members=this._getMembers();return true},getHierarchies:function(){return this._hierarchyDefs},getHierarchyNames:function(){var ab=[],Z,aa=this.numHierarchies;for(Z=0;Z<aa;Z++){ab[Z]=this._hierarchyOrder[Z]}return ab},hierarchyCount:function(){return this.numHierarchies},hierarchyIndex:function(Z){if(O(Z)){return this._hierarchyIndex}var aa=this._hierarchyIndexes[Z];if(O(aa)){n.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",Z)._throw()}return aa},hierarchyName:function(Z){if(O(Z)){Z=this._hierarchyIndex}if(Z!==parseInt(Z,10)||Z>=this.numHierarchies){n.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",Z)._throw()}return this._hierarchyOrder[Z]},hierarchy:function(ac){if(O(ac)){ab=this._hierarchyIndex}var ab,Z,aa;if(i(ac)){if(ac!==parseInt(ac,10)||ac>=this.numHierarchies){n.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",ac)._throw()}Z=this.hierarchyName(ac)}else{Z=ac}aa=this._hierarchyDefs[Z];if(O(aa)){n.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",Z)._throw()}return aa},member:function(ac){if(O(ac)){ab=this._hierarchyIndex}var ab,Z,aa;switch(typeof(ac)){case"string":ab=this.hierarchyIndex(ac);Z=ac;break;case"number":if(ac!==parseInt(ac,10)||ac>=this.numHierarchies){n.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",ac)._throw()}ab=ac;break}return this._member(ab)},_member:function(ab){var ae=this._members.item(ab),Z=this.hierarchyName(ab),aa=this.hierarchy(Z),ad,af={index:ab,hierarchy:Z},ac;for(ad in aa){if(ad==="index"||ad==="name"){continue}ac=U(ae,X,"",ad);switch(ac.length){case 0:af[ad]=aa[ad];break;case 1:af[ad]=u(ac.item(0));break;default:n.Exception._newError("UNEXPECTED_ERROR_READING_MEMBER","Xmla.Dataset.Axis.member",ad)._throw()}}return af},readAsArray:function(ab){if(!ab){ab=[]}var Z,aa=this.numHierarchies;for(Z=0;Z<aa;Z++){ab[Z]=this._member(Z)}return ab},readAsObject:function(Z){if(!Z){Z={}}var aa,ab=this.numHierarchies;for(aa=0;aa<ab;aa++){Z[this._hierarchyOrder[aa]]=this._member(aa)}return Z},fetchAsArray:function(Z){if(this.hasMoreTuples()){Z=this.readAsArray(Z);this.nextTuple()}else{Z=false}return Z},fetchAsObject:function(Z){if(this.hasMoreTuples(Z)){Z=this.readAsObject();this.nextTuple()}else{Z=false}return Z},fetchAllAsArray:function(Z){var aa;if(!Z){Z=[]}while((aa=this.fetchAsArray())){Z.push(aa)}return Z},fetchAllAsObject:function(Z){var aa;if(!Z){Z=[]}while((aa=this.fetchAsObject())){Z.push(aa)}return Z}};n.Dataset.Cellset=function(Z){this._dataset=Z;this._initCellset();return this};n.Dataset.Cellset.prototype={_dataset:null,_cellNodes:null,_cellCount:null,_cellNode:null,_cellProperties:null,_idx:null,_cellOrd:null,_initCellset:function(){var al=this._dataset._root,aa,ab,ah,am,ad,Z,ac,aj,ai,ak,an,ag,af,ae;aa=B(al,"CellData");if(!aa){n.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",al)._throw()}ab=U(aa,t,y,"element");ah=ab.length;ad=U(al,X,"","CellInfo");if(!ad||ad.length===0){n.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",al)._throw()}Z=ad.item(0);ai=U(Z,X,"","*");this._cellProperties={};ag=ai.length;for(af=0;af<ag;af++){ak=ai.item(af);an=ak.tagName;for(ae=0;ae<ah;ae++){am=ab.item(ae);if(am.getAttribute("name")!==an){continue}aj=am.getAttribute("type");this._cellProperties[an]=a[aj];this["cell"+an]=new Function('return this.cellProperty("'+an+'")');break}}this._cellNodes=U(al,X,"","Cell");this._cellCount=this._cellNodes.length;this.reset()},_getCellNode:function(Z){if(!O(Z)){this._idx=Z}this._cellNode=this._cellNodes.item(this._idx);this._cellOrd=this._getCellOrdinal(this._cellNode)},_getCellOrdinal:function(Z){return parseInt(Z.getAttribute("CellOrdinal"),10)},cellCount:function(){return this._cellNodes.length},reset:function(Z){this._idx=Z?Z:0;this._getCellNode()},hasMoreCells:function(){return this._idx<this._cellCount},nextCell:function(){this._idx+=1;if(this.hasMoreCells()){this._getCellNode();return this._cellOrd}else{this._idx=0;return -1}},curr:function(){return this._idx},hasCellProperty:function(Z){return !O(this._cellProperties[Z])},cellProperty:function(aa){var ad,ab,Z,ac=U(this._cellNode,X,"",aa).item(0);ad=J(ac);Z=this._cellProperties[aa];if(!Z){ab=Q(ac,W,T,"type");Z=P(ab)}return Z(ad)},cellOrdinal:function(){return this._cellOrd},fetchAsArrayOfValues:function(){var ab=[];for(var aa=0,Z=this._dataset.getAxis(n.Dataset.AXIS_COLUMNS).numTuples;aa<Z;aa++){ab[ab.length]=this.cellValue();this.nextCell()}return ab},fetchAllAsArrayOfValues:function(){var aa,Z=[];while((aa=this.fetchAsArrayOfValues())&&(this.hasMoreCells())){Z.push(aa)}return Z},eachRow:function(ac,ab,Z){if(O(ab)){ab=this}var aa=[null];if(!O(Z)){if(!H(Z)){Z=[Z]}aa=aa.concat(Z)}var ae,ad=[];while((ae=this.fetchAsArrayOfValues())&&(this.hasMoreCells())){aa[0]=ae;if(ac.apply(ab,aa)===false){return false}}return true},_readCell:function(ab,Z){var ad,aa,ac;for(ad in this._cellProperties){aa=U(ab,X,"",ad).item(0);if(!aa){continue}ac=this._cellProperties[ad];if(ac){Z[ad]=ac(u(aa))}else{if(ad==="Value"){Z[ad]=J(aa)}else{Z[ad]=u(aa)}}}Z.ordinal=this._getCellOrdinal(ab);return Z},readCell:function(Z){if(!Z){Z={}}return this._readCell(this._cellNode,Z)},eachCell:function(ac,ab,Z){var aa=[null];if(!ab){ab=this}if(Z){if(!H(Z)){Z=[Z]}aa=aa.concat(Z)}while(this.hasMoreCells()){this.nextCell();aa[0]=this.readCell();if(ac.apply(ab,aa)===false){return false}}this._idx=0;return true},getByIndex:function(aa,Z){this._getCellNode(aa);return this.readCell(Z)},getByOrdinal:function(aa,ac){var ad,ab,Z,ae=this.cellCount()-1;Z=aa>ae?ae:aa;while(true){ad=this._cellNodes.item(Z);ab=this._getCellOrdinal(ad);if(ab===aa){return this.getByIndex(Z,ac)}else{if(ab>aa){Z--}else{return null}}}},cellOrdinalForTupleIndexes:function(){throw"Not implemented"},getByTupleIndexes:function(){return this.getByOrdinal(this.cellOrdinalForTupleIndexes.apply(this,arguments))},close:function(){this._dataset=null;this._cellNodes=null;this._cellNode=null}};n.Exception=function(ab,ad,ac,Z,af,ae,aa){this.type=ab;this.code=ad;this.message=ac;this.source=af;this.helpfile=Z;this.data=ae;this.args=aa;return this};n.Exception.TYPE_WARNING="warning";n.Exception.TYPE_ERROR="error";var o="http://code.google.com/p/xmla4js/wiki/ExceptionCodes";n.Exception.MISSING_REQUEST_TYPE_CDE=-1;n.Exception.MISSING_REQUEST_TYPE_MSG="Missing_Request_Type";n.Exception.MISSING_REQUEST_TYPE_HLP=o+"#"+n.Exception.MISSING_REQUEST_TYPE_CDE+"_"+n.Exception.MISSING_REQUEST_TYPE_MSG;n.Exception.MISSING_STATEMENT_CDE=-2;n.Exception.MISSING_STATEMENT_MSG="Missing_Statement";n.Exception.MISSING_STATEMENT_HLP=o+"#"+n.Exception.MISSING_STATEMENT_CDE+"_"+n.Exception.MISSING_STATEMENT_MSG;n.Exception.MISSING_URL_CDE=-3;n.Exception.MISSING_URL_MSG="Missing_URL";n.Exception.MISSING_URL_HLP=o+"#"+n.Exception.MISSING_URL_CDE+"_"+n.Exception.MISSING_URL_MSG;n.Exception.NO_EVENTS_SPECIFIED_CDE=-4;n.Exception.NO_EVENTS_SPECIFIED_MSG="No_Events_Specified";n.Exception.NO_EVENTS_SPECIFIED_HLP=o+"#"+n.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+n.Exception.NO_EVENTS_SPECIFIED_MSG;n.Exception.WRONG_EVENTS_FORMAT_CDE=-5;n.Exception.WRONG_EVENTS_FORMAT_MSG="Wrong_Events_Format";n.Exception.WRONG_EVENTS_FORMAT_HLP=o+"#"+n.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+n.Exception.NO_EVENTS_SPECIFIED_MSG;n.Exception.UNKNOWN_EVENT_CDE=-6;n.Exception.UNKNOWN_EVENT_MSG="Unknown_Event";n.Exception.UNKNOWN_EVENT_HLP=o+"#"+n.Exception.UNKNOWN_EVENT_CDE+"_"+n.Exception.UNKNOWN_EVENT_MSG;n.Exception.INVALID_EVENT_HANDLER_CDE=-7;n.Exception.INVALID_EVENT_HANDLER_MSG="Invalid_Events_Handler";n.Exception.INVALID_EVENT_HANDLER_HLP=o+"#"+n.Exception.INVALID_EVENT_HANDLER_CDE+"_"+n.Exception.INVALID_EVENT_HANDLER_MSG;n.Exception.ERROR_PARSING_RESPONSE_CDE=-8;n.Exception.ERROR_PARSING_RESPONSE_MSG="Error_Parsing_Response";n.Exception.ERROR_PARSING_RESPONSE_HLP=o+"#"+n.Exception.ERROR_PARSING_RESPONSE_CDE+"_"+n.Exception.ERROR_PARSING_RESPONSE_MSG;n.Exception.INVALID_FIELD_CDE=-9;n.Exception.INVALID_FIELD_MSG="Invalid_Field";n.Exception.INVALID_FIELD_HLP=o+"#"+n.Exception.INVALID_FIELD_CDE+"_"+n.Exception.INVALID_FIELD_MSG;n.Exception.HTTP_ERROR_CDE=-10;n.Exception.HTTP_ERROR_MSG="HTTP Error";n.Exception.HTTP_ERROR_HLP=o+"#"+n.Exception.HTTP_ERROR_CDE+"_"+n.Exception.HTTP_ERROR_MSG;n.Exception.INVALID_HIERARCHY_CDE=-11;n.Exception.INVALID_HIERARCHY_MSG="Invalid_Hierarchy";n.Exception.INVALID_HIERARCHY_HLP=o+"#"+n.Exception.INVALID_HIERARCHY_CDE+"_"+n.Exception.INVALID_HIERARCHY_MSG;n.Exception.UNEXPECTED_ERROR_READING_MEMBER_CDE=-12;n.Exception.UNEXPECTED_ERROR_READING_MEMBER_MSG="Error_Reading_Member";n.Exception.UNEXPECTED_ERROR_READING_MEMBER_HLP=o+"#"+n.Exception.UNEXPECTED_ERROR_READING_MEMBER_CDE+"_"+n.Exception.UNEXPECTED_ERROR_READING_MEMBER_MSG;n.Exception.INVALID_AXIS_CDE=-13;n.Exception.INVALID_AXIS_MSG="The requested axis does not exist.";n.Exception.INVALID_AXIS_HLP=o+"#"+n.Exception.INVALID_AXIS_CDE+"_"+n.Exception.INVALID_AXIS_MSG;n.Exception.ILLEGAL_ARGUMENT_CDE=-14;n.Exception.ILLEGAL_ARGUMENT_MSG="Illegal arguments";n.Exception.ILLEGAL_ARGUMENT_HLP=o+"#"+n.Exception.ILLEGAL_ARGUMENT_CDE+"_"+n.Exception.ILLEGAL_ARGUMENT_MSG;n.Exception._newError=function(Z,ab,aa){return new n.Exception(n.Exception.TYPE_ERROR,n.Exception[Z+"_CDE"],n.Exception[Z+"_MSG"],n.Exception[Z+"_HLP"],ab,aa)};n.Exception.prototype={type:null,code:null,message:null,source:null,helpfile:null,data:null,_throw:function(){throw this},args:null,toString:function(){return this.type+" "+this.code+": "+this.message},getStackTrace:function(){var aa,Z="",ac=/^\sfunction\s*([^\(]+)?\s*\(\)$/;if(this.args){var ab=this.args.callee;while(ab){aa=String(ab);ab=ab.caller}}return Z}}}(exports?exports:window));